var version="2.2.0",enableSetToggleDebug,activityLogChartDurationByEndpoint,activityDurationChart,activityLogChartLatestRequestsDuration,reportActivityMaxAvgDurationChart,activityLogChartMaxAndAvgMonthlyDuration,activityOverTimeOfDayChart,activityLogChartOverTimeOfDay,fileFormatYAML,fileFormatJSON,fileFormats,customFieldTypeInteger,customFieldTypeDecimal,customFieldTypeText,customFieldTypeBoolean,customFieldTypeMultiChoice,customFieldTypeDate,customFieldTypes,keyPairAlgoECDSAP256,keyPairAlgoECDSAP384,keyPairAlgoECDSAP521,keyPairAlgoRSA2048,keyPairAlgoRSA4096,keyPairAlgoED25519,keyPairAlgoTypes,activityLog,manageAPIKeys,manageApp,manageApps,bsTooltip,createLicense,listCustomFieldsDefined,modalCustomFieldDefined,headerBtns,listKeyPairs,modalKeyPair,licenses,login,manageLicense,modalDisableLicense,modalNote,modalRenewLicense,toolsClearActivityLog,toolsClearLogins,userProfile,userLogins,manageUsers,modalChangePassword,modalActivate2FA,modalDeactivate2FA,defaultTimeout=1500,msgTypes={danger:"alert-danger",info:"alert-info",success:"alert-success",warning:"alert-warning",primary:"alert-primary"};function isEmail(e){var t=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;return t.test(e)}enableSetToggleDebug=!1;function setToggle(e,t,n){var o,s="#"+e;n&&(s="."+e),o=document.querySelectorAll(s),enableSetToggleDebug&&(console.log("**setToggle debugging**"),console.log("  querySelector (given):     ",e),console.log("  querySelector (understood):",s),console.log("  num elements selected:     ",o.length),console.log("  toggle to set on:          ",t)),o.forEach(function(e){var n=e.querySelectorAll(".btn");n.forEach(function(e){e.classList.remove("active");var n=e.querySelector("input");if(n.checked=!1,t===void 0)return;e.dataset.switch===t.toString()?(e.classList.add("active"),n.checked=!0):enableSetToggleDebug&&console.log("  mismatched data-switch:    ",e.dataset.switch,t)})})}function todayPlus(e){var o=new Date,t=new Date(o.setDate(o.getDate()+e)),i=t.getFullYear(),n=t.getMonth()+1,s=t.getDate(),a=i.toString(),r=n<10?"0"+n.toString():n.toString(),c=s<10?"0"+s.toString():s.toString();return a+"-"+r+"-"+c}function dateAdd(e,t){var n=e.split("-"),r=parseInt(n[0]),c=parseInt(n[1])-1,l=parseInt(n[2]),a=new Date(r,c,l),s=new Date(a.setDate(a.getDate()+t)),d=s.getFullYear(),o=s.getMonth()+1,i=s.getDate(),u=d.toString(),h=o<10?"0"+o.toString():o.toString(),m=i<10?"0"+i.toString():i.toString();return u+"-"+h+"-"+m}function isValidDate(e){var n,s,o,i,t=e.split("-");return t.length===3&&(o=t[0],o.length===4&&!(parseInt(o)<2e3)&&(n=t[1],n.length===2&&!(parseInt(n)<1||parseInt(n)>12)&&(s=t[2],s.length===2&&!(parseInt(s)<1||parseInt(s)>31)&&(i=/^\d{4}-\d{2}-\d{2}$/,e.match(i)!=null))))}document.getElementById("activityLogChartDurationByEndpoint")&&(activityLogChartDurationByEndpoint=new Vue({name:"activityLogChartDurationByEndpoint",delimiters:["[[","]]"],el:"#activityLogChartDurationByEndpoint",data:{showHelp:!1,rawData:[],msg:"",msgType:"",urls:{maxAvgDuration:"/api/activity-log/duration-by-endpoint/"}},methods:{getData:function(){this.msg="Retrieving data, this may take a while...",this.msgType=msgTypes.primary;var n,e=new URLSearchParams(document.location.search),t=!0;e.has("ignorePDF")&&e.get("ignorePDF")==="false"&&(t=!1),n={ignorePDF:t},fetch(get(this.urls.maxAvgDuration,n)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){activityLogChartDurationByEndpoint.msg=t,activityLogChartDurationByEndpoint.msgType=msgTypes.danger;return}activityLogChartDurationByEndpoint.rawData=e.Data||[],activityLogChartDurationByEndpoint.msg="",activityLogChartDurationByEndpoint.buildChart()}).catch(function(e){console.log("fetch() error: >>",e,"<<"),activityLogChartDurationByEndpoint.msg="An unknown error occurred. Please try again.",activityLogChartDurationByEndpoint.msgType=msgTypes.danger})}},mounted:function(){this.getData()}})),activityDurationChart=void 0,document.getElementById("activityLogChartLatestRequestsDuration")&&(activityLogChartLatestRequestsDuration=new Vue({name:"activityLogChartLatestRequestsDuration",delimiters:["[[","]]"],el:"#activityLogChartLatestRequestsDuration",data:{showHelp:!1,rawData:[],msg:"",msgType:"",urls:{latestDur:"/api/activity-log/latest-requests-duration/"}},methods:{getData:function(){this.msg="Retrieving data, this may take a while...",this.msgType=msgTypes.primary;var n,e=new URLSearchParams(document.location.search),t=!0;e.has("ignorePDF")&&e.get("ignorePDF")==="false"&&(t=!1),n={ignorePDF:t},fetch(get(this.urls.latestDur,n)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){activityLogChartLatestRequestsDuration.msg=t,activityLogChartLatestRequestsDuration.msgType=msgTypes.danger;return}activityLogChartLatestRequestsDuration.rawData=e.Data||[],activityLogChartLatestRequestsDuration.msg="",activityLogChartLatestRequestsDuration.buildChart()}).catch(function(e){console.log("fetch() error: >>",e,"<<"),activityLogChartLatestRequestsDuration.msg="An unknown error occurred. Please try again.",activityLogChartLatestRequestsDuration.msgType=msgTypes.danger})},buildChart:function(){o="activity-request-duration-chart",i=document.getElementById(o),e=[],t=[];for(var e,t,s,o,i,r,n=0,a=this.rawData;n<a.length;n++)s=a[n],e.push(s.DatetimeCreated),t.push(s.TimeDuration);r={legend:{display:!1},scales:{y:{type:"linear",position:"left",ticks:{min:0,maxTicksLimit:10}}},animation:{duration:0},plugins:{tooltip:{callbacks:{title:function(e){var n=e[0].dataIndex,t=activityLogChartLatestRequestsDuration.rawData[n];return t.Method+": "+t.URL},label:function(e){var n=e.dataIndex,t=activityLogChartLatestRequestsDuration.rawData[n];return t.DatetimeCreated+" ("+t.TimeDuration+"ms)"}}}}},activityDurationChart=new Chart(i,{type:"bar",data:{labels:e,datasets:[{label:"Duration (ms)",backgroundColor:"#007bff",data:t,fill:!1,lineTension:0}]},options:r})}},mounted:function(){this.getData()}})),reportActivityMaxAvgDurationChart=void 0,document.getElementById("activityLogChartMaxAndAvgMonthlyDuration")&&(activityLogChartMaxAndAvgMonthlyDuration=new Vue({name:"activityLogChartMaxAndAvgMonthlyDuration",delimiters:["[[","]]"],el:"#activityLogChartMaxAndAvgMonthlyDuration",data:{showHelp:!1,rawData:[],msg:"",msgType:"",urls:{maxAvgDuration:"/api/activity-log/max-and-avg-monthly-duration/"}},methods:{getData:function(){this.msg="Retrieving data, this may take a while...",this.msgType=msgTypes.primary;var n,e=new URLSearchParams(document.location.search),t=!0;e.has("ignorePDF")&&e.get("ignorePDF")==="false"&&(t=!1),n={ignorePDF:t},fetch(get(this.urls.maxAvgDuration,n)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){activityLogChartMaxAndAvgMonthlyDuration.msg=t,activityLogChartMaxAndAvgMonthlyDuration.msgType=msgTypes.danger;return}activityLogChartMaxAndAvgMonthlyDuration.rawData=e.Data||[],activityLogChartMaxAndAvgMonthlyDuration.msg="",activityLogChartMaxAndAvgMonthlyDuration.buildChart()}).catch(function(e){console.log("fetch() error: >>",e,"<<"),activityLogChartMaxAndAvgMonthlyDuration.msg="An unknown error occurred. Please try again.",activityLogChartMaxAndAvgMonthlyDuration.msgType=msgTypes.danger})},buildChart:function(){i="activity-max-avg-duration-chart",a=document.getElementById(i),t=[],n=[],s=[];for(var e,t,n,s,i,a,c,l,o=0,r=this.rawData;o<r.length;o++)e=r[o],c=e.Year+"-"+e.Month,t.push(c),n.push(e.AverageTimeDuration),s.push(e.MaxTimeDuration);l={legend:{display:!0},scales:{leftYAxis:{type:"linear",position:"left",min:0},rightYAxis:{type:"linear",position:"right",min:0,grid:{display:!1,displayOnChartArea:!1}}},animation:{duration:0}},reportActivityMaxAvgDurationChart=new Chart(a,{type:"line",data:{labels:t,datasets:[{label:"Avg. (ms, left)",borderColor:"#007bff",data:n,borderWidth:2,yAxisID:"leftYAxis",fill:!1,lineTension:0},{label:"Max. (ms, right)",borderColor:"#17a2b8",borderWidth:2,borderDash:[5,5],data:s,yAxisID:"rightYAxis",fill:!1,lineTension:0}]},options:l})}},mounted:function(){this.getData()}})),activityOverTimeOfDayChart=void 0,document.getElementById("activityLogChartOverTimeOfDay")&&(activityLogChartOverTimeOfDay=new Vue({name:"activityLogChartOverTimeOfDay",delimiters:["[[","]]"],el:"#activityLogChartOverTimeOfDay",data:{showHelp:!1,rawData:[],msg:"",msgType:"",urls:{overTimeOfDay:"/api/activity-log/over-time-of-day/"}},methods:{getData:function(){this.msg="Retrieving data, this may take a while...",this.msgType=msgTypes.primary;var e={};fetch(get(this.urls.overTimeOfDay,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){activityLogChartOverTimeOfDay.msg=t,activityLogChartOverTimeOfDay.msgType=msgTypes.danger;return}activityLogChartOverTimeOfDay.rawData=e.Data||[],activityLogChartOverTimeOfDay.msg="",activityLogChartOverTimeOfDay.buildChart()}).catch(function(e){console.log("fetch() error: >>",e,"<<"),activityLogChartOverTimeOfDay.msg="An unknown error occurred. Please try again.",activityLogChartOverTimeOfDay.msgType=msgTypes.danger})},buildChart:function(){s="activity-over-time-of-day-chart",o=document.getElementById(s),t=[];for(var e,t,s,o,a,r,n=0,i=this.rawData;n<i.length;n++)e=i[n],a={x:e.HoursMinutesDecimal,y:e.Count,hours:e.HourBracket,minutes:e.MinuteBracket},t.push(a);r={scales:{x:{type:"linear",ticks:{min:0,max:24,stepSize:1}}},animation:{duration:0},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){var t,n=e.raw.hours.toString();return n.length===1&&(n="0"+n),t=e.raw.minutes.toString(),t.length===1&&(t="0"+t),e.raw.y+" @ "+n+":"+t}}}}},activityOverTimeOfDayChart=new Chart(o,{type:"scatter",data:{datasets:[{label:"points",data:t,borderColor:"#007bff"}]},options:r})}},mounted:function(){this.getData()}}));function objectToString(e){var t=Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&");return t}function removeDoubleSlash(e){return e.includes("//")&&console.log("URL contains a double slash, this should be fixed.",e),e=e.replace(/\/\//g,"/"),e}function get(e,t){e=removeDoubleSlash(e);var n={method:"GET",credentials:"same-origin",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}},s=objectToString(t);return e=e+"?"+s,new Request(e,n)}function post(e,t){e=removeDoubleSlash(e);var n={method:"POST",credentials:"same-origin",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}},s=objectToString(t);return n.body=s,new Request(e,n)}function postFile(e,t){e=removeDoubleSlash(e);var n={method:"POST",credentials:"same-origin",body:t};return new Request(e,n)}function handleRequestErrors(e){var t=[200,500];return t.indexOf(e.status)==-1?Promise.reject(new Error(e.statusText)):Promise.resolve(e)}function getJSON(e){var t=e.json();return t}function handleAPIErrors(e){return e.OK===!1?e.ErrorData.Message:""}fileFormatYAML="yaml",fileFormatJSON="json",fileFormats=[fileFormatYAML,fileFormatJSON],customFieldTypeInteger="Integer",customFieldTypeDecimal="Decimal",customFieldTypeText="Text",customFieldTypeBoolean="Boolean",customFieldTypeMultiChoice="Multi-Choice",customFieldTypeDate="Date",customFieldTypes=[customFieldTypeInteger,customFieldTypeDecimal,customFieldTypeText,customFieldTypeMultiChoice,customFieldTypeBoolean,customFieldTypeDate],keyPairAlgoECDSAP256="ECDSA (P256)",keyPairAlgoECDSAP384="ECDSA (P384)",keyPairAlgoECDSAP521="ECDSA (P521)",keyPairAlgoRSA2048="RSA (2048-bit)",keyPairAlgoRSA4096="RSA (4096-bit)",keyPairAlgoED25519="ED25519",keyPairAlgoTypes=[keyPairAlgoECDSAP256,keyPairAlgoECDSAP384,keyPairAlgoECDSAP521,keyPairAlgoRSA2048,keyPairAlgoRSA4096,keyPairAlgoED25519],document.getElementById("activityLog")&&(activityLog=new Vue({name:"activityLog",delimiters:["[[","]]"],el:"#activityLog",data:{showHelp:!1,userID:0,apiKeyID:0,endpoint:"",searchFor:"",rows:200,startDate:"",endDate:"",prettyPrintJSON:!1,showReferrer:!1,activities:[],activitiesRetrieved:!1,users:[],usersRetrieved:!1,apiKeys:[],apiKeysRetrieved:!1,endpoints:[],endpointsRetrieved:!1,msg:"",msgType:"",submitting:!1,urls:{getLatest:"/api/activity-log/latest/",getEndpoints:"/api/activity-log/latest/filter-by-endpoints/",getUsers:"/api/users/",getAPIKeys:"/api/api-keys/"}},methods:{getUsers:function(){var e={};fetch(get(this.urls.getUsers,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){activityLog.msg=t,activityLog.msgType=msgTypes.danger;return}activityLog.users=e.Data||[],activityLog.usersRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),activityLog.msg="An unknown error occurred. Please try again.",activityLog.msgType=msgTypes.danger})},getAPIKeys:function(){var e={};fetch(get(this.urls.getAPIKeys,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){activityLog.msg=t,activityLog.msgType=msgTypes.danger;return}activityLog.apiKeys=e.Data||[],activityLog.apiKeysRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),activityLog.msg="An unknown error occurred. Please try again.",activityLog.msgType=msgTypes.danger})},getFilterByEndpoints:function(){var e={};fetch(get(this.urls.getEndpoints,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){activityLog.msg=t,activityLog.msgType=msgTypes.danger;return}activityLog.endpoints=e.Data||[],activityLog.endpointsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),activityLog.msg="An unknown error occurred. Please try again.",activityLog.msgType=msgTypes.danger})},getActivities:function(){if(this.userID>0&&this.apiKeyID>0&&(this.msg="Please choose a User or an API Key, not both.",this.msgType=msgTypes.danger),this.startDate!==""&&this.endDate===""){this.msgFilters="You must choose an End Date since you chose a Start Date.";return}if(this.endDate!==""&&this.startDate===""){this.msgFilters="You must choose an Start Date since you chose an End Date.";return}if(this.startDate!==""&&!isValidDate(this.startDate)){this.msgFilters="The Start Date you provided is not valid.";return}if(this.endDate!==""&&!isValidDate(this.endDate)){this.msgFilters="The End Date you provided is not valid.";return}this.msg="Getting activities...",this.msgType=msgTypes.primary;var e={userID:this.userID,apiKeyID:this.apiKeyID,endpoint:this.endpoint,searchFor:this.searchFor,rows:this.rows,startDate:this.startDate,endDate:this.endDate};fetch(get(this.urls.getLatest,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){activityLog.msg=t,activityLog.msgType=msgTypes.danger;return}activityLog.activities=e.Data||[],activityLog.activitiesRetrieved=!0,activityLog.msg=""}).catch(function(e){console.log("fetch() error: >>",e,"<<"),activityLog.msg="An unknown error occurred. Please try again.",activityLog.msgType=msgTypes.danger})},setPrettyPrint:function(e){this.prettyPrintJSON=e},setShowReferrer:function(e){this.showReferrer=e}},mounted:function(){this.getUsers(),this.getAPIKeys(),this.getFilterByEndpoints(),this.getActivities(),setToggle("prettyPrintJSON",this.prettyPrintJSON),setToggle("showReferrer",this.showReferrer)}})),document.getElementById("manageAPIKeys")&&(manageAPIKeys=new Vue({name:"manageAPIKeys",delimiters:["[[","]]"],el:"#manageAPIKeys",data:{addingNew:!1,keys:[],keysRetrieved:!1,msgLoad:"",msgLoadType:"",apiKeySelectedID:0,keyData:{Description:"",K:""},showRevokeConfirm:!1,submitting:!1,msgSave:"",msgSaveType:"",urls:{getKeys:"/api/api-keys/",generate:"/api/api-keys/generate/",revoke:"/api/api-keys/revoke/",update:"/api/api-keys/update/"}},computed:{addEditCardTitle:function(){return this.addingNew?"Add API Key":"View API Key"}},methods:{getKeys:function(){var e={};fetch(get(this.urls.getKeys,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageAPIKeys.msgLoad=t,manageAPIKeys.msgLoadType=msgTypes.danger;return}manageAPIKeys.keys=e.Data||[],manageAPIKeys.keysRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageAPIKeys.msgLoad="An unknown error occurred. Please try again.",manageAPIKeys.msgLoadType=msgTypes.danger})},setField:function(e,t){this.keyData[e]=t},setUIState:function(){if(this.addingNew){this.addingNew=!this.addingNew;return}this.addingNew=!this.addingNew,this.resetKeyData(),this.msgSave="",this.msgSaveType=""},resetKeyData:function(){this.keyData={Description:"",K:""},this.apiKeySelectedID=0,this.showRevokeConfirm=!1,Vue.nextTick(function(){for(t in manageAPIKeys.keyData){var t,e=manageAPIKeys.keyData[t];(e===!0||e===!1)&&setToggle(t,e)}})},showAPIKey:function(){if(this.apiKeySelectedID<1)return;n=function(t){if(t.ID!==e.apiKeySelectedID)return"continue";e.keyData=t,Vue.nextTick(function(){for(n in t){var n,e=t[n];(e===!0||e===!1)&&setToggle(n,e)}})},e=this;for(var e,n,o,t=0,s=this.keys;t<s.length;t++)o=s[t],n(o);this.showRevokeConfirm=!1},createKey:function(){if(this.submitting){console.log("already submitting");return}if(this.msgSaveType=msgTypes.danger,this.keyData.Description===""){this.msgSave="You must provide a description for this API key so you can recognize what it is used for.";return}this.msgSaveType=msgTypes.primary,this.msgSave="Creating API Key...",this.submitting=!0,this.keyData.K="";var e={data:JSON.stringify(this.keyData)};fetch(post(this.urls.generate,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageAPIKeys.msgSave=t,manageAPIKeys.msgSaveType=msgTypes.danger,manageAPIKeys.submitting=!1;return}manageAPIKeys.getKeys(),setTimeout(function(){manageAPIKeys.msgSaveType="",manageAPIKeys.msgSave="",manageAPIKeys.submitting=!1,manageAPIKeys.apiKeySelectedID=e.Data,manageAPIKeys.addingNew=!1,manageAPIKeys.showAPIKey()},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageAPIKeys.msgSave="An unknown error occurred. Please try again.",manageAPIKeys.msgSaveType=msgTypes.danger,manageAPIKeys.submitting=!1})},revoke:function(e){if(this.submitting){console.log("already submitting");return}if(e<1){this.msgSave="Could not determine which API key to revoke",this.msgSaveType=msgTypes.danger;return}this.msgSaveType=msgTypes.danger,this.msgSave="Revoking...",this.submitting=!0;var t={id:this.apiKeySelectedID};fetch(post(this.urls.revoke,t)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageAPIKeys.msgSave=t,manageAPIKeys.msgSaveType=msgTypes.danger,manageAPIKeys.submitting=!1;return}manageAPIKeys.msgSaveType=msgTypes.primary,manageAPIKeys.msgSave="API key was revoked successfully!",setTimeout(function(){manageAPIKeys.msgSaveType="",manageAPIKeys.msgSave="",manageAPIKeys.submitting=!1,manageAPIKeys.apiKeySelectedID=0,manageAPIKeys.resetKeyData(),manageAPIKeys.getKeys()},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageAPIKeys.msgSave="An unknown error occurred. Please try again.",manageAPIKeys.msgSaveType=msgTypes.danger,manageAPIKeys.submitting=!1})},handleRevokeConfirm:function(){this.showRevokeConfirm=!0,setTimeout(function(){manageAPIKeys.showRevokeConfirm=!1},3e3)},update:function(){if(this.submitting){console.log("already submitting");return}if(this.msgSaveType=msgTypes.danger,this.keyData.ID<1){this.msgSave="Could not determine which API Key you want to update.";return}this.msgSaveType=msgTypes.primary,this.msgSave="Saving...",this.submitting=!0;var e={data:JSON.stringify(this.keyData)};fetch(post(this.urls.update,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageAPIKeys.msgSave=t,manageAPIKeys.msgSaveType=msgTypes.danger,manageAPIKeys.submitting=!1;return}manageAPIKeys.msgSaveType=msgTypes.primary,manageAPIKeys.msgSave="Changes saved!",setTimeout(function(){manageAPIKeys.msgSaveType="",manageAPIKeys.msgSave="",manageAPIKeys.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageAPIKeys.msgSave="An unknown error occurred. Please try again.",manageAPIKeys.msgSaveType=msgTypes.danger,manageAPIKeys.submitting=!1})}},mounted:function(){this.getKeys()}})),document.getElementById("manageApp")&&(manageApp=new Vue({name:"manageApp",delimiters:["[[","]]"],el:"#manageApp",data:{settings:{},submitting:!1,msg:"",msgType:"",urls:{get:"/api/app-settings/",save:"/api/app-settings/update/"}},methods:{getData:function(){var e={};fetch(get(this.urls.get,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageApp.msg=t,manageApp.msgType=msgTypes.danger;return}manageApp.settings=e.Data,Vue.nextTick(function(){for(var e in manageApp.settings){if(e==="ID"||e==="DatetimeModified")continue;setToggle(e,manageApp.settings[e])}})}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApp.msgSettings="An unknown error occured.  Please try again.",manageApp.msgSettingsType=msgTypes.danger})},save:function(){if(this.submitting){console.log("already submitting...");return}this.msg="Saving...",this.msgType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.settings)};fetch(post(this.urls.save,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageApp.msg=t,manageApp.msgType=msgTypes.danger,manageApp.submitting=!1;return}manageApp.msg="Changes saved!",manageApp.msgType=msgTypes.success,setTimeout(function(){manageApp.msg="",manageApp.msgType=""},defaultTimeout),manageApp.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApp.msg="An unknown error occured.  Please try again.",manageApp.msgType=msgTypes.danger,manageApp.submitting=!1})},setField:function(e,t){this.settings[e]=t}},mounted:function(){this.getData()}})),document.getElementById("manageApps")&&(manageApps=new Vue({name:"manageApps",delimiters:["[[","]]"],el:"#manageApps",data:{addingNew:!1,apps:[],appsRetrieved:!1,msgLoad:"",msgLoadType:"",fileFormats,defaultFileFormat:fileFormatYAML,appSelectedID:0,appData:{},submitting:!1,msgSave:"",msgSaveType:"",urls:{get:"/api/apps/",add:"/api/apps/add/",update:"/api/apps/update/"}},computed:{addEditCardTitle:function(){return this.addingNew?"Add App":"Edit App"}},methods:{setField:function(e,t){this.appData[e]=t},resetForm:function(){this.appData={Name:"",DaysToExpiration:365,FileFormat:this.defaultFileFormat,DownloadFilename:"",ShowLicenseID:!0,ShowAppName:!0,Active:!0},Vue.nextTick(function(){setToggle("ShowLicenseID",!0),setToggle("ShowAppName",!0),setToggle("Active",!0)}),this.appSelectedID=0,this.msgSave="",this.msgSaveType=""},setUIState:function(){if(this.addingNew){this.addingNew=!1;return}this.addingNew=!0,this.resetForm(),this.deselectApp()},getApps:function(){var e={};fetch(get(this.urls.get,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageApps.msgLoad=t,manageApps.msgLoadType=msgTypes.danger;return}manageApps.apps=e.Data||[],manageApps.appsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApps.msgLoad="An unknown error occured. Please try again.",manageApps.msgLoadType=msgTypes.danger})},showApp:function(){if(this.appSelectedID<1)return;s=function(t){return t.ID!==e.appSelectedID?"continue":(e.appData=t,Vue.nextTick(function(){setToggle("ShowLicenseID",t.ShowLicenseID),setToggle("ShowAppName",t.ShowAppName),setToggle("Active",t.Active)}),e.setAppInOtherVueObjects(e.appSelectedID),{value:void 0})},e=this;for(var e,n,s,i,t=0,o=this.apps;t<o.length;t++)if(i=o[t],n=s(i),typeof n=="object")return n.value},setAppInOtherVueObjects:function(e){listKeyPairs.setAppID(e),modalKeyPair.setAppID(e),listCustomFieldsDefined.setAppID(e),modalCustomFieldDefined.setAppID(e)},deselectApp:function(){this.setAppInOtherVueObjects(0)},setDefaultDownloadFilename:function(){if(this.appData.Name.trim()==="")return;if(this.appData.DownloadFilename.trim()!=="")return;var e=this.appData.Name.trim().replace(/ /g,"_");this.appData.DownloadFilename=e.toLowerCase()+".txt"},addOrUpdate:function(){if(this.msgSaveType=msgTypes.danger,this.appData.Name.trim()===""){this.msgSave="You must provide the name for your app.";return}if(this.appData.DaysToExpiration<0){this.msgSave="The default license period cannot be less than 0 days.";return}if(!this.fileFormats.includes(this.appData.FileFormat.trim())){this.msgSave="Please choose a file format from the provided options.";return}if(this.appData.DownloadFilename.trim()===""){this.msgSave="You must provide the filename your licenses for this app will be downloaded as.";return}this.appData.ID!==void 0?this.update():this.add()},add:function(){if(this.submitting){console.log("already submitting...");return}this.msgSave="Adding...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.appData)};fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageApps.msgSave=t,manageApps.msgSaveType=msgTypes.danger,manageApps.submitting=!1;return}manageApps.getApps(),manageApps.msgSave="Added! Make sure you add the necessary key pairs and custom fields!",manageApps.msgSaveType=msgTypes.success,setTimeout(function(){manageApps.appSelectedID=e.Data,manageApps.showApp(),manageApps.setUIState(),manageApps.msgSave="",manageApps.msgLoadType="",manageApps.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApps.msgSave="An unknown error occured. Please try again.",manageApps.msgSaveType=msgTypes.danger,manageApps.submitting=!1})},update:function(){if(this.submitting){console.log("already submitting...");return}if(isNaN(this.appData.ID)||this.appData.ID===""||this.appData.ID<1){this.msgSave="Could not determine which app you are trying to update. Please refresh the page and try again.",this.msgSaveType=msgTypes.danger;return}this.msgSave="Saving...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.appData)};fetch(post(this.urls.update,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageApps.msgSave=t,manageApps.msgSaveType=msgTypes.danger,manageApps.submitting=!1;return}manageApps.msgSave="Changes saved!",manageApps.msgSaveType=msgTypes.success,setTimeout(function(){manageApps.msgSave="",manageApps.msgSaveType="",manageApps.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApps.msgSave="An unknown error occured. Please try again.",manageApps.msgSaveType=msgTypes.danger,manageApps.submitting=!1})}},mounted:function(){this.getApps()}})),bsTooltip=function(e,t){var s,n=[];if(t.modifiers.focus&&n.push("focus"),t.modifiers.hover&&n.push("hover"),t.modifiers.click&&n.push("click"),n.length||n.push("hover"),t.value===void 0)return;s=!1,e.dataset.html&&(s=!0),$(e).tooltip({title:t.value,placement:t.arg||"top",trigger:n.join(" "),html:s})},Vue.directive("tooltip",{bind:bsTooltip,update:bsTooltip,unbind:function(e){$(e).tooltip("dispose")}}),document.getElementById("createLicense")&&(createLicense=new Vue({name:"createLicense",delimiters:["[[","]]"],el:"#createLicense",data:{apps:[],appsRetrieved:!1,appSelectedID:0,keyPairs:[],keyPairsRetrieved:!1,fields:[],fieldsRetrieved:!1,customFieldTypeInteger,customFieldTypeDecimal,customFieldTypeText,customFieldTypeBoolean,customFieldTypeMultiChoice,customFieldTypeDate,separator:";",licenseData:{KeyPairID:0,CompanyName:"ACME Dynamite",ContactName:"Wyle E Coyote",PhoneNumber:"123-555-1212",Email:"wyle@example.com",ExpireDate:""},submitting:!1,msg:"",msgType:"",urls:{getApps:"/api/apps/",getKeyPairs:"/api/key-pairs/",getCustomFields:"/api/custom-fields/defined/",add:"/api/licenses/add/",getAPIKeys:"/api/api-keys/"},showAPIBuilder:!1,returnLicenseFile:!1,apiKeys:[],apiKeysRetrieved:!1,apiBuilderMsg:"",apiBuilderMsgType:"",apiKeySelected:""},methods:{setField:function(e,t){this.fields[e].BoolValue=t},getApps:function(){var e={};fetch(get(this.urls.getApps,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){createLicense.msg=t,createLicense.msgType=msgTypes.danger;return}createLicense.apps=e.Data||[],createLicense.appsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.msg="An unknown error occured. Please try again.",createLicense.msgType=msgTypes.danger})},getKeyPairs:function(){var e={appID:this.appSelectedID,activeOnly:!0};fetch(get(this.urls.getKeyPairs,e)).then(handleRequestErrors).then(getJSON).then(function(e){if(t=handleAPIErrors(e),t!==""){createLicense.msg=t,createLicense.msgType=msgTypes.danger;return}createLicense.keyPairs=e.Data||[],createLicense.keyPairsRetrieved=!0;for(var t,s,n=0,o=createLicense.keyPairs;n<o.length;n++)if(s=o[n],s.IsDefault){createLicense.licenseData.KeyPairID=s.ID;break}}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.msg="An unknown error occured. Please try again.",createLicense.msgType=msgTypes.danger})},getCustomFields:function(){var e={appID:this.appSelectedID,activeOnly:!0};fetch(get(this.urls.getCustomFields,e)).then(handleRequestErrors).then(getJSON).then(function(e){if(t=handleAPIErrors(e),t!==""){createLicense.msgLoad=t,createLicense.msgLoadType=msgTypes.danger;return}createLicense.fields=e.Data||[],createLicense.fieldsRetrieved=!0,s=function(e){switch(e.Type){case customFieldTypeInteger:e.IntegerValue=e.IntegerDefaultValue;break;case customFieldTypeDecimal:e.DecimalValue=e.DecimalDefaultValue;break;case customFieldTypeText:e.TextValue=e.TextDefaultValue;break;case customFieldTypeBoolean:e.BoolValue=e.BoolDefaultValue,Vue.nextTick(function(){var t="cf_bool_id_"+e.ID.toString();setToggle(t,e.BoolDefaultValue)});break;case customFieldTypeMultiChoice:e.MultiChoiceValue=e.MultiChoiceDefaultValue;break;case customFieldTypeDate:e.DateValue=todayPlus(e.DateDefaultIncrement);break;default:}};for(var t,s,i,n=0,o=createLicense.fields;n<o.length;n++)i=o[n],s(i)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.msgLoad="An unknown error occured.  Please try again.",createLicense.msgLoadType=msgTypes.danger})},setExpireDate:function(){for(var t,e=0,n=this.apps;e<n.length;e++)if(t=n[e],t.ID===this.appSelectedID){this.licenseData.ExpireDate=todayPlus(t.DaysToExpiration);break}},todayPlusOne:function(){return todayPlus(1)},today:function(){var e=new Date,s=e.getFullYear(),t=e.getMonth()+1,n=e.getDate(),o=s.toString(),i=t<10?"0"+t.toString():t.toString(),a=n<10?"0"+n.toString():n.toString();return o+"-"+i+"-"+a},create:function(){if(this.msgType=msgTypes.danger,this.appSelectedID<1){this.msg="You must choose an app.";return}if(this.licenseData.KeyPairID<1){this.msg="You must choose a key pair.";return}if(this.licenseData.CompanyName.trim()===""){this.msg="You must provide the company name for which this license is for.";return}if(this.licenseData.ContactName.trim()===""){this.msg="You must provide the contact name of who requested this license.";return}if(this.licenseData.PhoneNumber.trim()===""){this.msg="You must provide a phone number.";return}if(this.licenseData.Email.trim()===""){this.msg="You must provide an email address.";return}if(!isEmail(this.licenseData.Email)){this.msg="The email address you provided is not valid.";return}if(this.licenseData.ExpireDate.trim()===""){this.msg="You must provide an expiration date for the license.";return}for(var e,n,s,t=0;t<this.fields.length;t++){switch(e=this.fields[t],e.Type){case customFieldTypeInteger:if(isNaN(e.IntegerValue)||Number.isNaN(parseInt(e.IntegerValue.toString()))||!Number.isInteger(e.IntegerValue)){this.msg="You must provide an integer for the "+e.Name+" field.";return}if(e.IntegerValue<e.NumberMinValue||e.IntegerValue>e.NumberMaxValue){this.msg="The value for the "+e.Name+" field must be an integer between "+e.NumberMinValue.toFixed(0)+" and "+e.NumberMaxValue.toFixed(0)+".";return}break;case customFieldTypeDecimal:if(isNaN(e.DecimalValue)||Number.isNaN(parseInt(e.DecimalValue.toString()))){this.msg="You must provide an number for the "+e.Name+" field.";return}if(e.DecimalValue<e.NumberMinValue||e.DecimalValue>e.NumberMaxValue){this.msg="The value for the "+e.Name+" field must be an number between "+e.NumberMinValue.toFixed(2)+" and "+e.NumberMaxValue.toFixed(2)+".";return}break;case customFieldTypeText:break;case customFieldTypeBoolean:break;case customFieldTypeMultiChoice:if(n=e.MultiChoiceOptions.split(this.separator),!n.includes(e.MultiChoiceValue)){this.msg="You must choose a value for the "+e.Name+" field.";return}break;case customFieldTypeDate:if(e.DateValue.trim()===""){this.msg="You must choose a date for the "+e.Name+"field.";return}break;default:}e.CustomFieldDefinedID!==0&&e.ID>0&&(e.CustomFieldDefinedID=e.ID,e.ID=0),e.CreatedByUserID=0,e.DatetimeCreated="",e.DatetimeModified=""}if(this.submitting){console.log("already submitting...");return}this.msg="Saving...",this.msgType=msgTypes.primary,this.submitting=!0,s={licenseData:JSON.stringify(this.licenseData),customFields:JSON.stringify(this.fields)},fetch(post(this.urls.add,s)).then(handleRequestErrors).then(getJSON).then(function(e){var t,n=handleAPIErrors(e);if(n!==""){createLicense.msg=n,createLicense.msgType=msgTypes.danger,createLicense.submitting=!1;return}if(t=e.Data,t===void 0){createLicense.msg="Could not determine where to redirect you. This is an odd error...",createLicense.msgType=msgTypes.warning;return}createLicense.msg="License created! Redirecting to license...",createLicense.msgType=msgTypes.primary,setTimeout(function(){window.location.href="/app/licensing/license/?id="+t},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.msg="An unknown error occured. Please try again.",createLicense.msgType=msgTypes.danger,createLicense.submitting=!1})},getAPIKeys:function(){if(this.apiKeysRetrieved)return;var e={};fetch(get(this.urls.getAPIKeys,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){createLicense.apiBuilderMsg=t,createLicense.apiBuilderMsgType=msgTypes.danger;return}createLicense.apiKeys=e.Data||[],createLicense.apiKeysRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.apiBuilderMsg="An unknown error occured.  Please try again.",createLicense.apiBuilderMsgType=msgTypes.danger})}},computed:{getAPIRequestFieldsObject:function(){t={};for(var e,t,n=0,s=this.fields;n<s.length;n++)switch(e=s[n],e.Type){case customFieldTypeInteger:t[e.Name]=e.IntegerValue;break;case customFieldTypeDecimal:t[e.Name]=e.DecimalValue;break;case customFieldTypeText:t[e.Name]=e.TextValue;break;case customFieldTypeBoolean:t[e.Name]=e.BoolValue;break;case customFieldTypeMultiChoice:t[e.Name]=e.MultiChoiceValue;break;case customFieldTypeDate:t[e.Name]=e.DateValue;break;default:}return t},showAPIRequest:function(){if(this.appSelectedID<1||this.licenseData.KeyPairID<1||!this.fieldsRetrieved)return;var t,n=window.location.protocol,s=window.location.host,o=encodeURIComponent(JSON.stringify(this.getAPIRequestFieldsObject)),e=["curl '"+n+"//"+s+"/api/v1/licenses/add/'","-X POST","-H 'Content-type: application/x-www-form-urlencoded'","-d apiKey='"+this.apiKeySelected+"'","-d appID='"+this.appSelectedID+"'","-d keyPairID='"+this.licenseData.KeyPairID+"'","-d companyName='"+this.licenseData.CompanyName+"'","-d contactName='"+this.licenseData.ContactName+"'","-d phoneNumber='"+this.licenseData.PhoneNumber+"'","-d email='"+this.licenseData.Email+"'","-d expireDate='"+this.licenseData.ExpireDate+"'","-d fields="+o+""];return this.returnLicenseFile&&e.push("-d returnLicenseFile=true"),t=e.join(` \\
`),t}},mounted:function(){this.getApps(),setToggle("returnLicenseFile",!1)}})),document.getElementById("listCustomFieldsDefined")&&(listCustomFieldsDefined=new Vue({name:"listCustomFieldsDefined",delimiters:["[[","]]"],el:"#listCustomFieldsDefined",data:{appSelectedID:0,fields:[],fieldsRetrieved:!1,customFieldTypeInteger,customFieldTypeDecimal,customFieldTypeText,customFieldTypeBoolean,customFieldTypeMultiChoice,customFieldTypeDate,msgLoad:"",msgLoadType:"",collapseUI:!1,urls:{get:"/api/custom-fields/defined/"}},methods:{setAppID:function(e){if(this.appSelectedID=e,e===0){this.fields=[],this.msgLoad="";return}this.getCustomFields()},getCustomFields:function(){var e={appID:this.appSelectedID,activeOnly:!0};fetch(get(this.urls.get,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){listCustomFieldsDefined.msgLoad=t,listCustomFieldsDefined.msgLoadType=msgTypes.danger;return}listCustomFieldsDefined.fields=e.Data||[],listCustomFieldsDefined.fieldsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),listCustomFieldsDefined.msgLoad="An unknown error occured. Please try again.",listCustomFieldsDefined.msgLoadType=msgTypes.danger})},passToModal:function(e){modalCustomFieldDefined.setModalData(e)}}})),document.getElementById("modal-customFieldDefined")&&(modalCustomFieldDefined=new Vue({name:"modalCustomFieldDefined",delimiters:["[[","]]"],el:"#modal-customFieldDefined",data:{appSelectedID:0,fieldData:{},customFieldTypes,customFieldTypeInteger,customFieldTypeDecimal,customFieldTypeText,customFieldTypeBoolean,customFieldTypeMultiChoice,customFieldTypeDate,separator:";",submitting:!1,msgSave:"",msgSaveType:"",urls:{add:"/api/custom-fields/defined/add/",update:"/api/custom-fields/defined/update/",delete:"/api/custom-fields/defined/delete/"}},computed:{adding:function(){return this.fieldData.ID===void 0||this.fieldData.ID<1},multiChoiceOptions:function(){if(this.fieldData.MultiChoiceOptions===void 0)return[];if(this.fieldData.Type!==this.customFieldTypeMultiChoice)return[];if(this.fieldData.MultiChoiceOptions.trim().length===0)return[];s=this.fieldData.MultiChoiceOptions.split(this.separator),t=[];for(var e,t,s,n=0,o=s;n<o.length;n++){if(e=o[n],e=e.trim(),e==="")continue;if(t.includes(e))continue;t.push(e)}return t}},methods:{setAppID:function(e){this.appSelectedID=e},setModalData:function(e){if(this.resetModal(),e===void 0)return;switch(this.fieldData=e,e.Type){case this.customFieldTypeBoolean:Vue.nextTick(function(){setToggle("BoolDefaultValue",e.BoolDefaultValue)});break}},resetModal:function(){this.fieldData={ID:void 0,DatetimeCreated:"",DatetimeModified:"",CreatedByUserID:0,Active:!0,AppID:this.appSelectedID,Name:"",Type:"",Instructions:"",IntegerDefaultValue:0,DecimalDefaultValue:0,TextDefaultValue:"",BoolDefaultValue:!1,MultiChoiceDefaultValue:"",DateDefaultIncrement:0,NumberMinValue:0,NumberMaxValue:0,MultiChoiceOptions:""},this.submitting=!1,this.msgSave="",this.msgSaveType=""},setField:function(e,t){this.fieldData[e]=t},setToggleDefaultIfBool:function(){Vue.nextTick(function(){setToggle("BoolDefaultValue",modalCustomFieldDefined.fieldData.BoolDefaultValue)})},addOrUpdate:function(){if(this.msgSaveType=msgTypes.danger,this.fieldData.Name.trim()===""){this.msgSave="You must provide a name for this field.";return}switch(this.fieldData.Type){case customFieldTypeInteger:if(this.fieldData.NumberMinValue===void 0||this.fieldData.NumberMaxValue===void 0){this.msgSave="You must provide both the minimum and maximum value for the numbers you allow in this field.";return}if(!Number.isInteger(this.fieldData.NumberMinValue)||!Number.isInteger(this.fieldData.NumberMinValue)){this.msgSave="The minimum and maximum values must be integers (no decimals).";return}if(this.fieldData.NumberMinValue>=this.fieldData.NumberMaxValue){this.msgSave="The minimum value must be less than the maximum.";return}if(this.fieldData.IntegerDefaultValue===void 0){this.msgSave="You must provide a default value for this field.";return}if(!Number.isInteger(this.fieldData.IntegerDefaultValue)){this.msgSave="The default must be an integer (no decimals).";return}if(this.fieldData.IntegerDefaultValue<this.fieldData.NumberMinValue||this.fieldData.IntegerDefaultValue>this.fieldData.NumberMaxValue){this.msgSave="The default value must be within the minimum to maximum range.";return}break;case customFieldTypeDecimal:if(this.fieldData.NumberMinValue===void 0||this.fieldData.NumberMaxValue===void 0){this.msgSave="You must provide both the minimum and maximum value for the numbers you allow in this field.";return}if(this.fieldData.NumberMinValue>=this.fieldData.NumberMaxValue){this.msgSave="The minimum value must be less than the maximum.";return}if(this.fieldData.DecimalDefaultValue===void 0){this.msgSave="You must provide a default value for this field.";return}if(this.fieldData.DecimalDefaultValue<this.fieldData.NumberMinValue||this.fieldData.DecimalDefaultValue>this.fieldData.NumberMaxValue){this.msgSave="The default value must be within the minimum to maximum range.";return}break;case customFieldTypeText:if(this.fieldData.TextDefaultValue===void 0||this.fieldData.TextDefaultValue.trim()===""){this.msgSave="You must provide a default value for this field.";return}break;case customFieldTypeBoolean:if(this.fieldData.BoolDefaultValue===void 0||this.fieldData.BoolDefaultValue!==!0&&this.fieldData.BoolDefaultValue!==!1){this.msgSave="You must choose a default value for this field.";return}break;case customFieldTypeMultiChoice:if(this.fieldData.MultiChoiceOptions===void 0||this.fieldData.MultiChoiceOptions===""){this.msgSave="You must provide at least one option.";return}s=this.fieldData.MultiChoiceOptions.split(this.separator),t=[];for(var e,t,s,n=0,o=s;n<o.length;n++){if(e=o[n],e=e.trim(),e==="")continue;if(t.includes(e)){this.msgSave='The option "'+e+'" is included more than once. Please remove the duplicate(s).';return}t.push(e)}if(t.length===0){this.msgSave="You must provide as least one option for this field.";return}if(this.fieldData.MultiChoiceDefaultValue===void 0||this.fieldData.MultiChoiceDefaultValue.trim()===""){this.msgSave="You must choose a default value for this field.";return}if(!t.includes(this.fieldData.MultiChoiceDefaultValue)){this.msgSave="Please choose a default value from the list of options your provided.";return}this.fieldData.MultiChoiceOptions=t.join(this.separator);break;case customFieldTypeDate:if(this.fieldData.DateDefaultIncrement===void 0||this.fieldData.DateDefaultIncrement<0){this.msgSave="Please provide the number of days from the date the license is created to calculate the date set for this field.";return}break;default:this.msgSave="Please choose an field type from the provided options.";return}this.fieldData.ID!==void 0?this.update():this.add()},add:function(){if(this.submitting){console.log("already submitting...");return}this.msgSave="Adding...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.fieldData)};fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalCustomFieldDefined.msgSave=t,modalCustomFieldDefined.msgSaveType=msgTypes.danger,modalCustomFieldDefined.submitting=!1;return}listCustomFieldsDefined.getCustomFields(),modalCustomFieldDefined.msgSave="Added!",modalCustomFieldDefined.msgSaveType=msgTypes.success,setTimeout(function(){modalCustomFieldDefined.resetModal(),modalCustomFieldDefined.msgSave="",modalCustomFieldDefined.msgSaveType="",modalCustomFieldDefined.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalCustomFieldDefined.msgSave="An unknown error occured. Please try again.",modalCustomFieldDefined.msgSaveType=msgTypes.danger,modalCustomFieldDefined.submitting=!1})},update:function(){if(this.submitting){console.log("already submitting...");return}if(isNaN(this.fieldData.ID)||this.fieldData.ID===""||this.fieldData.ID<1){this.msgSave="Could not determine which field you are trying to update. Please refresh the page and try again.",this.msgSaveType=msgTypes.danger;return}this.msgSave="Saving...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.fieldData)};fetch(post(this.urls.update,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalCustomFieldDefined.msgSave=t,modalCustomFieldDefined.msgSaveType=msgTypes.danger,modalCustomFieldDefined.submitting=!1;return}modalCustomFieldDefined.msgSave="Changes saved!",modalCustomFieldDefined.msgSaveType=msgTypes.success,setTimeout(function(){modalCustomFieldDefined.msgSave="",modalCustomFieldDefined.msgSaveType="",modalCustomFieldDefined.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalCustomFieldDefined.msgSave="An unknown error occured. Please try again.",modalCustomFieldDefined.msgSaveType=msgTypes.danger,modalCustomFieldDefined.submitting=!1})},remove:function(){if(this.submitting){console.log("already submitting...");return}if(isNaN(this.fieldData.ID)||this.fieldData.ID===""||this.fieldData.ID<1){this.msgSave="Could not determine which field you are trying to delete. Please refresh the page and try again.",this.msgSaveType=msgTypes.danger;return}this.msgSave="Deleting...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={id:this.fieldData.ID};fetch(post(this.urls.delete,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalCustomFieldDefined.msgSave=t,modalCustomFieldDefined.msgSaveType=msgTypes.danger;return}listCustomFieldsDefined.getCustomFields(),modalCustomFieldDefined.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalCustomFieldDefined.msgSave="An unknown error occured. Please try again.",modalCustomFieldDefined.msgSaveType=msgTypes.danger,modalCustomFieldDefined.submitting=!1})}},mounted:function(){this.resetModal()}})),document.getElementById("headerBtns")&&(headerBtns=new Vue({name:"headerBtns",delimiters:["[[","]]"],el:"#headerBtns",data:{usernameHovered:!1}})),document.getElementById("listKeyPairs")&&(listKeyPairs=new Vue({name:"listKeyPairs",delimiters:["[[","]]"],el:"#listKeyPairs",data:{appSelectedID:0,keyPairs:[],keyPairsRetrieved:!1,msgLoad:"",msgLoadType:"",collapseUI:!1,urls:{get:"/api/key-pairs/"}},methods:{setAppID:function(e){if(this.appSelectedID=e,e===0){this.keyPairs=[],this.msgLoad="";return}this.getKeyPairs()},getKeyPairs:function(){var e={appID:this.appSelectedID,activeOnly:!0};fetch(get(this.urls.get,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){listKeyPairs.msgLoad=t,listKeyPairs.msgLoadType=msgTypes.danger;return}listKeyPairs.keyPairs=e.Data||[],listKeyPairs.keyPairsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),listKeyPairs.msgLoad="An unknown error occured. Please try again.",listKeyPairs.msgLoadType=msgTypes.danger})},passToModal:function(e){modalKeyPair.setModalData(e)}}})),document.getElementById("modal-keyPair")&&(modalKeyPair=new Vue({name:"modalKeyPair",delimiters:["[[","]]"],el:"#modal-keyPair",data:{appSelectedID:0,keyPairData:{},algorithmTypes:keyPairAlgoTypes,defaultAlgorithmType:keyPairAlgoED25519,showPublicKey:!1,submitting:!1,msgSave:"",msgSaveType:"",urls:{add:"/api/key-pairs/add/",delete:"/api/key-pairs/delete/",setDefault:"/api/key-pairs/set-default/"}},computed:{adding:function(){return this.keyPairData.ID===void 0||this.keyPairData.ID<1},publicKeyNumLines:function(){return this.keyPairData.PublicKey===void 0||this.keyPairData.PublicKey.trim()===""?2:this.keyPairData.PublicKey.split(`
`).length}},methods:{setAppID:function(e){this.appSelectedID=e},setModalData:function(e){if(this.resetModal(),e===void 0)return;this.keyPairData=e},resetModal:function(){this.keyPairData={ID:0,DatetimeCreated:"",DatetimeModified:"",CreatedByUserID:0,Active:!0,AppID:this.appSelectedID,Name:"",AlgorithmType:this.defaultAlgorithmType,PublicKey:"",IsDefault:!1},this.showPublicKey=!1,this.submitting=!1,this.msgSave="",this.msgSaveType=""},add:function(){if(this.submitting){console.log("already submitting...");return}if(this.msgSaveType=msgTypes.danger,this.keyPairData.Name.trim()===""){this.msgSave="You must provide a name for this key pair.";return}if(!this.algorithmTypes.includes(this.keyPairData.AlgorithmType)){this.msgSave="Please choose an algorithm from the provided options";return}this.msgSave="Generating key pair...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.keyPairData)};fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalKeyPair.msgSave=t,modalKeyPair.msgSaveType=msgTypes.danger,modalKeyPair.submitting=!1;return}modalKeyPair.keyPairData=e.Data,listKeyPairs.getKeyPairs(),modalKeyPair.msgSave="Added!",modalKeyPair.msgSaveType=msgTypes.success,modalKeyPair.submitting=!1,setTimeout(function(){modalKeyPair.msgSave="",modalKeyPair.msgSaveType=""},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalKeyPair.msgSave="An unknown error occured.  Please try again.",modalKeyPair.msgSaveType=msgTypes.danger,modalKeyPair.submitting=!1})},remove:function(){if(this.submitting){console.log("already submitting...");return}if(isNaN(this.keyPairData.ID)||this.keyPairData.ID===""||this.keyPairData.ID<1){this.msgSave="Could not determine which key pair you are trying to delete. Please refresh the page and try again.",this.msgSaveType=msgTypes.danger;return}this.msgSave="Deleting...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={id:this.keyPairData.ID};fetch(post(this.urls.delete,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalKeyPair.msgSave=t,modalKeyPair.msgSaveType=msgTypes.danger;return}listKeyPairs.getKeyPairs(),modalKeyPair.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalKeyPair.msgSave="An unknown error occured. Please try again.",modalKeyPair.msgSaveType=msgTypes.danger,modalKeyPair.submitting=!1})},setDefault:function(){if(this.submitting){console.log("already submitting...");return}if(isNaN(this.keyPairData.ID)||this.keyPairData.ID===""||this.keyPairData.ID<1){this.msgSave="Could not determine which key pair you want to set as default. Please refresh the page and try again.",this.msgSaveType=msgTypes.danger;return}this.msgSave="Setting default...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={id:this.keyPairData.ID};fetch(post(this.urls.setDefault,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalKeyPair.msgSave=t,modalKeyPair.msgSaveType=msgTypes.danger;return}listKeyPairs.getKeyPairs(),modalKeyPair.keyPairData.IsDefault=!0,modalKeyPair.submitting=!1,modalKeyPair.msgSave=""}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalKeyPair.msgSave="An unknown error occured. Please try again.",modalKeyPair.msgSaveType=msgTypes.danger,modalKeyPair.submitting=!1})}},mounted:function(){this.resetModal()}})),document.getElementById("licenses")&&(licenses=new Vue({name:"licenses",delimiters:["[[","]]"],el:"#licenses",data:{apps:[],appsRetrieved:!1,appSelectedID:0,rowLimit:20,activeOnly:!1,licenses:[],licensesRetrieved:!1,submitting:!1,msg:"",msgType:"",urls:{getApps:"/api/apps/",getLicenses:"/api/licenses/"}},methods:{getApps:function(){var e={activeOnly:!0};fetch(get(this.urls.getApps,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){licenses.msgLoad=t,licenses.msgLoadType=msgTypes.danger;return}licenses.apps=e.Data||[],licenses.appsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),licenses.msgLoad="An unknown error occured. Please try again.",licenses.msgLoadType=msgTypes.danger})},getLicenses:function(){this.appSelectedID<0&&(this.appSelectedID=0);var e={appID:this.appSelectedID,limit:this.rowLimit,activeOnly:this.activeOnly};fetch(get(this.urls.getLicenses,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){licenses.msgLoad=t,licenses.msgLoadType=msgTypes.danger;return}licenses.licenses=e.Data||[],licenses.licensesRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),licenses.msgLoad="An unknown error occured.  Please try again.",licenses.msgLoadType=msgTypes.danger})}},mounted:function(){this.getApps(),this.getLicenses()}})),document.getElementById("login")&&(login=new Vue({name:"login",delimiters:["[[","]]"],el:"#login",data:{username:"",password:"",msg:"",msgType:"",submitting:!1,show2FAInput:!1,twoFAVerificationCode:"",urls:{loginAuth:"/login/",mainApp:"/app/"}},methods:{login:function(){if(this.submitting){console.log("already submitting...");return}if(this.username.length===0)return;if(isEmail(this.username)===!1){this.msg="You must provide an email address as a username.",this.msgType=msgTypes.danger;return}if(this.password.length===0){this.msg="You must provide a password.",this.msgType=msgTypes.danger;return}if(this.show2FAInput&&this.twoFAVerificationCode.length!==6){this.msg="Your 2FA code must be exactly 6 numeric characters.",this.msgType=msgTypes.danger;return}this.msg="Logging in...",this.msgType=msgTypes.primary,this.submitting=!0;var e={username:this.username,password:this.password,twoFAToken:this.twoFAVerificationCode};fetch(post(this.urls.loginAuth,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t,n=handleAPIErrors(e);if(n!==""){login.msg=n,login.msgType=msgTypes.danger;return}if(t=e.Type,t==="login2FATokenRequired"){login.show2FAInput=!0,login.msg="",Vue.nextTick(function(){document.getElementById("token").focus()});return}if(t==="login2FAForced"){login.msg="2 Factor Authentication (2FA) is required but you do not have it set up.  Please see an administator to set up 2FA.",login.msgType=msgTypes.danger;return}if(t==="loginOK"){window.location.href=login.urls.mainApp;return}console.log("unhandled or invalid login response:",t),login.msg="An unknown error occured.  Please contact an administator.",login.msgType=msgTypes.danger}).catch(function(e){console.log("fetch() error: >>",e,"<<"),login.msg="An unknown error occured.  Please try again.",login.msgType=msgTypes.danger}),this.submitting=!1}},mounted:function(){document.getElementById("username").focus()}})),document.getElementById("manageLicense")&&(manageLicense=new Vue({name:"manageLicense",delimiters:["[[","]]"],el:"#manageLicense",data:{licenseID:0,licenseData:{},licenseDataRetrieved:!1,customFieldResults:[],downloadHistory:[],notes:[],msgLicenseData:"",msgLicenseDataType:"",msgHistory:"",msgHistoryType:"",msgNotes:"",msgNotesType:"",showAdvancedInfo:!1,customFieldTypeInteger,customFieldTypeDecimal,customFieldTypeText,customFieldTypeBoolean,customFieldTypeMultiChoice,customFieldTypeDate,urls:{getLicense:"/api/licenses/",getCustomFields:"/api/custom-fields/results/",getHistory:"/api/licenses/history/",getNotes:"/api/licenses/notes/"}},methods:{getLicense:function(){var e={id:this.licenseID};fetch(get(this.urls.getLicense,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageLicense.msgLicenseData=t,manageLicense.msgLicenseDataType=msgTypes.danger;return}manageLicense.licenseData=e.Data,manageLicense.licenseDataRetrieved=!0,manageLicense.passData()}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageLicense.msgLicenseData="An unknown error occured.  Please try again.",manageLicense.msgLicenseDataType=msgTypes.danger})},getCustomFieldResults:function(){var e={licenseID:this.licenseID};fetch(get(this.urls.getCustomFields,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageLicense.msgLicenseData=t,manageLicense.msgLicenseDataType=msgTypes.danger;return}manageLicense.customFieldResults=e.Data||[]}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageLicense.msgLicenseData="An unknown error occured.  Please try again.",manageLicense.msgLicenseDataType=msgTypes.danger})},getDownloadHistory:function(){var e={licenseID:this.licenseID};fetch(get(this.urls.getHistory,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageLicense.msgHistory=t,manageLicense.msgHistoryType=msgTypes.danger;return}manageLicense.downloadHistory=e.Data||[]}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageLicense.msgHistory="An unknown error occured.  Please try again.",manageLicense.msgHistoryType=msgTypes.danger})},refreshDownloadHistory:function(){var e=500;setTimeout(manageLicense.getDownloadHistory,e)},getNotes:function(){var e={licenseID:this.licenseID};fetch(get(this.urls.getNotes,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageLicense.msgNotes=t,manageLicense.msgNotesType=msgTypes.danger;return}manageLicense.notes=e.Data||[]}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageLicense.msgNotes="An unknown error occured.  Please try again.",manageLicense.msgNotesType=msgTypes.danger})},setNoteModal:function(e){modalNote.initialize(e)},passData:function(){modalDisableLicense.licenseID=this.licenseID,modalNote.licenseID=this.licenseID,modalRenewLicense.licenseID=this.licenseID,modalRenewLicense.currentExpireDate=this.licenseData.ExpireDate}},mounted:function(){var e=parseInt(document.getElementById("licenseID").value);this.licenseID=e,this.getLicense(),this.getCustomFieldResults(),this.getDownloadHistory(),this.getNotes()}})),document.getElementById("modal-disableLicense")&&(modalDisableLicense=new Vue({name:"modalDisableLicense",delimiters:["[[","]]"],el:"#modal-disableLicense",data:{licenseID:0,note:"",submitting:!1,msgSave:"",msgSaveType:"",urls:{disableLicense:"/api/licenses/disable/"}},methods:{disableLicense:function(){if(this.submitting){console.log("already submitting");return}if(this.msgSaveType=msgTypes.danger,this.licenseID<1){this.msgSave="Could not determine which license you want to disabled.";return}if(this.note.trim()===""){this.msgSave="You must provide a note describing why you are disabling this license.";return}this.msgSaveType=msgTypes.primary,this.msgSave="Disabling license...",this.submitting=!0;var e={id:this.licenseID,note:this.note};fetch(post(this.urls.disableLicense,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalDisableLicense.msgSave=t,modalDisableLicense.msgSaveType=msgTypes.danger,modalDisableLicense.submitting=!1;return}manageLicense.licenseData.Active=!1,manageLicense.getNotes(),modalDisableLicense.msgSave="License disabled!",modalDisableLicense.msgSaveType=msgTypes.primary}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalDisableLicense.msgSave="An unknown error occured. Please try again.",modalDisableLicense.msgSaveType=msgTypes.danger,modalDisableLicense.submitting=!1})}}})),document.getElementById("modal-note")&&(modalNote=new Vue({name:"modalNote",delimiters:["[[","]]"],el:"#modal-note",data:{licenseID:0,noteData:{LicenseID:0,Note:""},addingNew:!1,submitting:!1,msgSave:"",msgSaveType:"",urls:{add:"/api/licenses/notes/add/"}},computed:{modalTitle:function(){return this.addingNew?"Add Note":"Note Details"}},methods:{initialize:function(e){if(this.resetModal(),e===void 0){this.addingNew=!0;return}this.noteData=e,this.addingNew=!1},resetModal:function(){this.noteData={ID:0,LicenseID:0,Note:"",CreatedByUsername:"",DatetimeCreated:""},this.msgSave="",this.msgSaveType=""},add:function(){if(this.submitting){console.log("already submitting");return}if(this.msgSaveType=msgTypes.danger,this.licenseID<1){this.msgSave="Could not determine which license you want to add a note for.";return}if(this.noteData.Note.trim()===""){this.msgSave="You must provide a note.";return}this.msgSaveType=msgTypes.primary,this.msgSave="Adding note...",this.submitting=!0,this.noteData.LicenseID=this.licenseID;var e={data:JSON.stringify(this.noteData)};fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalNote.msgSave=t,modalNote.msgSaveType=msgTypes.danger,modalNote.submitting=!1;return}manageLicense.getNotes(),modalNote.msgSave="Note added!",modalNote.msgSaveType=msgTypes.primary,setTimeout(function(){modalNote.msgSave="",modalNote.msgSaveType="",modalNote.submitting=!1,modalNote.resetModal()},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalNote.msgSave="An unknown error occured. Please try again.",modalNote.msgSaveType=msgTypes.danger,modalNote.submitting=!1})}}})),document.getElementById("modal-renewLicense")&&(modalRenewLicense=new Vue({name:"modalRenewLicense",delimiters:["[[","]]"],el:"#modal-renewLicense",data:{licenseID:0,currentExpireDate:"",newExpireDate:"",renewed:!1,submitting:!1,msgSave:"",msgSaveType:"",urls:{renew:"/api/licenses/renew/"}},computed:{minDate:function(){return dateAdd(this.currentExpireDate,1)}},methods:{renew:function(){if(this.submitting){console.log("already submitting");return}if(this.msgSaveType=msgTypes.danger,this.licenseID<1){this.msgSave="Could not determine which license you want to renew.";return}if(this.newExpireDate===""){this.msgSave="You must provide the new expiration date.";return}this.msgSaveType=msgTypes.primary,this.msgSave="Renewing license...",this.submitting=!0;var e={id:this.licenseID,newExpireDate:this.newExpireDate};fetch(post(this.urls.renew,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t,n=handleAPIErrors(e);if(n!==""){modalRenewLicense.msgSave=n,modalRenewLicense.msgSaveType=msgTypes.danger,modalRenewLicense.submitting=!1;return}if(modalRenewLicense.msgSave="License Renewed!",modalRenewLicense.renewed=!0,t=e.Data,t===void 0){createLicense.msg="Could not determine where to redirect you. This is an odd error...",createLicense.msgType=msgTypes.warning;return}setTimeout(function(){window.location.href="/app/licensing/license/?id="+t},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalRenewLicense.msgSave="An unknown error occured. Please try again.",modalRenewLicense.msgSaveType=msgTypes.danger,modalRenewLicense.submitting=!1})}},mounted:function(){var e=parseInt(document.getElementById("licenseID").value);this.licenseID=e}})),document.getElementById("toolsClearActivityLog")&&(toolsClearActivityLog=new Vue({name:"toolsClearActivityLog",delimiters:["[[","]]"],el:"#toolsClearActivityLog",data:{priorToDate:"",msg:"",msgType:"",submitting:!1},methods:{clear:function(){if(this.priorToDate===""){this.msg="Invalid date provided.",this.msgType=msgTypes.danger;return}this.msg="Working...  This can take a while.",this.msgType=msgTypes.primary,this.submitting=!0;var e={priorToDate:this.priorToDate},t="/api/activity-log/clear/";fetch(post(t,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){toolsClearActivityLog.msg=t,toolsClearActivityLog.msgType=msgTypes.danger,toolsClearActivityLog.submitting=!1;return}toolsClearActivityLog.msg="Done! Rows deleted: "+e.Data,toolsClearActivityLog.msgType=msgTypes.success,setTimeout(function(){toolsClearActivityLog.msg="",toolsClearActivityLog.msgType=""},defaultTimeout*3),toolsClearActivityLog.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),toolsClearActivityLog.msg="An unknown error occured. Please try again.",toolsClearActivityLog.msgType=msgTypes.danger,toolsClearActivityLog.submitting=!1})}}})),document.getElementById("toolsClearLogins")&&(toolsClearLogins=new Vue({name:"toolsClearLogins",delimiters:["[[","]]"],el:"#toolsClearLogins",data:{priorToDate:"",msg:"",msgType:"",submitting:!1},methods:{clear:function(){if(this.priorToDate===""){this.msg="Invalid date provided.",this.msgType=msgTypes.danger;return}this.msg="Working...  This can take a while.",this.msgType=msgTypes.primary,this.submitting=!0;var e={priorToDate:this.priorToDate},t="/api/users/login-history/clear/";fetch(post(t,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){toolsClearLogins.msg=t,toolsClearLogins.msgType=msgTypes.danger,toolsClearLogins.submitting=!1;return}toolsClearLogins.msg="Done! Rows deleted: "+e.Data,toolsClearLogins.msgType=msgTypes.success,setTimeout(function(){toolsClearLogins.msg="",toolsClearLogins.msgType=""},defaultTimeout*3),toolsClearLogins.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),toolsClearLogins.msg="An unknown error occured. Please try again.",toolsClearLogins.msgType=msgTypes.danger,toolsClearLogins.submitting=!1})}}})),document.getElementById("userProfile")&&(userProfile=new Vue({name:"userProfile",delimiters:["[[","]]"],el:"#userProfile",data:{msg:"",msgType:"",userData:{},userDataRetrieved:!1,urls:{getUserData:"/api/user/"}},methods:{getUserData:function(){var e={};fetch(get(this.urls.getUserData,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){userProfile.msg=t,userProfile.msgType=msgTypes.danger;return}userProfile.userData=e.Data||[],userProfile.userDataRetrieved=!0,userProfile.populateUserIDInOtherVueObjects()}).catch(function(e){console.log("fetch() error: >>",e,"<<"),userProfile.msg="An unknown error occured. Please try again.",userProfile.msgType=msgTypes.danger})},populateUserIDInOtherVueObjects:function(){modalChangePassword.setUserData(this.userData.ID),modalActivate2FA.setUserData(this.userData.ID),modalDeactivate2FA.setUserData(this.userData.ID)},resetChangePasswordModal:function(){modalChangePassword.resetModal()},reset2FAActivationModal:function(){modalActivate2FA.resetModal()}},mounted:function(){this.getUserData();var e=document.getElementById("minPasswordLength").value;this.minPasswordLength=parseInt(e)}})),document.getElementById("userLogins")&&(userLogins=new Vue({name:"userLogins",delimiters:["[[","]]"],el:"#userLogins",data:{userID:0,rows:50,logins:[],loginsRetrieved:!1,users:[],usersRetrieved:!1,msg:"",msgType:"",submitting:!1,urls:{getUsers:"/api/users/",getLogins:"/api/user-logins/latest/"}},methods:{getUsers:function(){var e={};fetch(get(this.urls.getUsers,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){userLogins.msg=t,userLogins.msgType=msgTypes.danger;return}userLogins.users=e.Data||[],userLogins.usersRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),userLogins.msg="An unknown error occured. Please try again.",userLogins.msgType=msgTypes.danger})},getLogins:function(){this.msg="Getting user login history...",this.msgType=msgTypes.primary;var e={userID:this.userID,rows:this.rows};fetch(get(this.urls.getLogins,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){userLogins.msg=t,userLogins.msgType=msgTypes.danger;return}userLogins.logins=e.Data||[],userLogins.loginsRetrieved=!0,userLogins.msg=""}).catch(function(e){console.log("fetch() error: >>",e,"<<"),userLogins.msg="An unknown error occured. Please try again.",userLogins.msgType=msgTypes.danger})}},mounted:function(){this.getUsers(),this.getLogins()}})),document.getElementById("manageUsers")&&(manageUsers=new Vue({name:"manageUsers",delimiters:["[[","]]"],el:"#manageUsers",data:{addingNew:!1,msgLoad:"",msgLoadType:"",users:[],usersRetrieved:!1,userSelectedID:0,userData:{},submitting:!1,msgSave:"",msgSaveType:"",minPasswordLength:10,password1:"",password2:"",forceLogoutBtnText:"Force Logout",forceLogoutSubmitting:!1,urls:{get:"/api/users/",add:"/api/users/add/",update:"/api/users/update/",forceLogout:"/api/users/force-logout/"}},computed:{addEditCardTitle:function(){return this.addingNew?"Add User":"Edit User"}},methods:{getUsers:function(){var e={};fetch(get(this.urls.get,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageUsers.msgLoad=t,manageUsers.msgLoadType=msgTypes.danger;return}manageUsers.users=e.Data||[],manageUsers.usersRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageUsers.msgLoad="An unknown error occured.  Please try again.",manageUsers.msgLoadType=msgTypes.danger})},setField:function(e,t){this.userData[e]=t},setUIState:function(){if(this.addingNew){this.addingNew=!this.addingNew;return}this.addingNew=!this.addingNew,this.resetUserData(),this.msgSave="",this.msgSaveType=""},resetUserData:function(){this.userData={Username:"",Active:!1,Administrator:!1,CreateLicenses:!1,ViewLicenses:!1,PasswordInput1:"",PasswordInput2:""},this.userSelectedID=0,Vue.nextTick(function(){setToggle("btn-group-toggle",!1,!0)})},showUser:function(){if(this.userSelectedID<1)return;n=function(t){if(t.ID!==e.userSelectedID)return"continue";e.userData=t,Vue.nextTick(function(){for(n in t){var n,e=t[n];(e===!0||e===!1)&&setToggle(n,e)}}),modalChangePassword.setUserData(e.userSelectedID),modalActivate2FA.setUserData(e.userSelectedID),modalDeactivate2FA.setUserData(e.userSelectedID)},e=this;for(var e,n,o,t=0,s=this.users;t<s.length;t++)o=s[t],n(o)},update:function(){if(isNaN(this.userData.ID)||this.userData.ID===""||this.userData.ID<1){this.msgSave="An error occured. Please reload this page and try again.",this.msgSaveType=msgTypes.danger;return}this.msgSave="Saving...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.userData)};fetch(post(this.urls.update,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageUsers.msgSave=t,manageUsers.msgSaveType=msgTypes.danger,manageUsers.submitting=!1;return}manageUsers.msgSave="Changes saved!",manageUsers.msgSaveType=msgTypes.success,setTimeout(function(){manageUsers.msgSave="",manageUsers.msgSaveType="",manageUsers.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageUsers.msgSave="An unknown error occured.  Please try again.",manageUsers.msgSaveType=msgTypes.danger,manageUsers.submitting=!1})},add:function(){if(this.submitting){console.log("already submitting...");return}if(this.msgSaveType=msgTypes.danger,this.password1!==this.password2){this.msgSave="Passwords do not match.";return}if(this.password1.length<this.minPasswordLength){this.msgSave="The password you provided is too short. It must be at least "+this.minPasswordLength+" characters long.";return}this.msgSave="Adding...",this.msgSaveType=msgTypes.primary,this.submitting=!0,this.userData.PasswordInput1=this.password1,this.userData.PasswordInput2=this.password2;var e={data:JSON.stringify(this.userData)};fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageUsers.msgSave=t,manageUsers.msgSaveType=msgTypes.danger,manageUsers.submitting=!1;return}manageUsers.getUsers(),manageUsers.msgSave="Added!",manageUsers.msgSaveType=msgTypes.success,setTimeout(function(){manageUsers.resetUserData(),setToggle("btn-group-toggle",!1,!0),manageUsers.msgSave="",manageUsers.msgSaveType="",manageUsers.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageUsers.msgSave="An unknown error occured.  Please try again.",manageUsers.msgSaveType=msgTypes.danger,manageUsers.submitting=!1})},addOrUpdate:function(){if(this.submitting){console.log("already submitting...");return}if(this.msgSaveType=msgTypes.danger,this.userData.Username===""||this.userData.Username===void 0){this.msgSave="You must provide a username (email).";return}if(isEmail(this.userData.Username)===!1){this.msgSave="You must provide an email for a username";return}this.addingNew?this.add():this.update()},forceLogout:function(){if(this.forceLogoutSubmitting)return;this.forceLogoutSubmitting=!0,this.forceLogoutBtnText="Forcing logout...";var e={userID:this.userData.ID};fetch(post(this.urls.forceLogout,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){manageUsers.msgSave=t,manageUsers.msgSaveType=msgTypes.danger;return}manageUsers.msgSave="",manageUsers.forceLogoutBtnText="Forcing logout...done!",setTimeout(function(){manageUsers.forceLogoutBtnText="Force Logout",manageUsers.forceLogoutSubmitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageUsers.msgSave="An unknown error occured.  Please try again.",manageUsers.msgSaveType=msgTypes.danger,this.forceLogoutSubmitting=!1})},resetChangePasswordModal:function(){modalChangePassword.resetModal()},reset2FAActivationModal:function(){modalActivate2FA.resetModal()}},mounted:function(){this.getUsers();var e=document.getElementById("minPasswordLength").value;this.minPasswordLength=parseInt(e)}})),document.getElementById("modal-changePassword")&&(modalChangePassword=new Vue({name:"modalChangePassword",delimiters:["[[","]]"],el:"#modal-changePassword",data:{userID:0,minPasswordLength:10,password1:"",password2:"",submitting:!1,msg:"",msgType:"",urls:{changePassword:"/api/users/change-password/"}},methods:{setUserData:function(e){this.userID=e},save:function(){if(this.submitting){console.log("already submitting...");return}if(this.msgType=msgTypes.danger,this.userID<1){this.msg="Cannot determine what user you want to set a new password for. Please refresh this page.";return}if(this.password1!==this.password2){this.msg="Passwords do not match.";return}if(this.password1.length<this.minPasswordLength){this.msg="The password you provided is too short. It must be at least "+this.minPasswordLength+" characters long.";return}this.msgType=msgTypes.primary,this.msg="Saving new password",this.submitting=!0;var e={userID:this.userID,password1:this.password1,password2:this.password2};fetch(post(this.urls.changePassword,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalChangePassword.msg=t,modalChangePassword.msgType=msgTypes.danger,modalChangePassword.submitting=!1;return}modalChangePassword.msg="Password updated!",modalChangePassword.msgType=msgTypes.success,modalChangePassword.password1="",modalChangePassword.password2="",setTimeout(function(){modalChangePassword.msg="",modalChangePassword.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalChangePassword.msg="An unknown error occured.  Please try again.",modalChangePassword.msgType=msgTypes.danger,modalChangePassword.submitting=!1})},resetModal:function(){this.password1="",this.password2="",this.msg="",this.msgType="",this.submitting=!1}},mounted:function(){var e=document.getElementById("minPasswordLength").value;this.minPasswordLength=parseInt(e)}})),document.getElementById("modal-activate2FA")&&(modalActivate2FA=new Vue({name:"modalActivate2FA",delimiters:["[[","]]"],el:"#modal-activate2FA",data:{userID:0,twoFABarcode:"",twoFAVerificationCode:"",show2FAInfoOnly:!0,retrievingBarcode:!1,submitting:!1,msg:"",msgType:"",urls:{getQRCode:"/api/users/2fa/get-qr-code/",verify:"/api/users/2fa/verify/"}},methods:{setUserData:function(e){this.userID=e},getBarcode:function(){this.show2FAInfoOnly=!1,this.retrievingBarcode=!0;var e={userID:this.userID};fetch(get(this.urls.getQRCode,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(t!==""){modalActivate2FA.msg=t,modalActivate2FA.msgType=msgTypes.danger,modalActivate2FA.retrievingBarcode=!1;return}modalActivate2FA.twoFABarcode=e.Data,modalActivate2FA.retrievingBarcode=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalActivate2FA.msg="An unknown error occured.  Please try again.",modalActivate2FA.msgType=msgTypes.danger,modalActivate2FA.retrievingBarcode=!1})},validate:function(){this.submitting=!0;var e={userID:this.userID,validationCode:this.twoFAVerificationCode};fetch(post(this.urls.verify,e)).then(handleRequestErrors).then(getJSON).then(function(e){if(t=handleAPIErrors(e),t!==""){modalActivate2FA.msg=t,modalActivate2FA.msgType=msgTypes.danger,modalActivate2FA.submitting=!1;return}if(modalActivate2FA.msg="Code verified! 2 Factor Authentication is now enabled for this user.",modalActivate2FA.msgType=msgTypes.success,document.getElementById("manageUsers")){for(var t,s,n=0,o=manageUsers.users;n<o.length;n++)if(s=o[n],s.ID===modalActivate2FA.userID){s.TwoFactorAuthEnabled=!0;break}}else document.getElementById("userProfile")&&(userProfile.userData.TwoFactorAuthEnabled=!0)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalActivate2FA.msg="An unknown error occured. Please try again.",modalActivate2FA.msgType=msgTypes.danger,modalActivate2FA.submitting=!1})},resetModal:function(){this.msg="",this.msgType="",this.twoFABarcode="",this.twoFAVerificationCode="",this.show2FAInfoOnly=!0,this.submitting=!1}}})),document.getElementById("modal-deactivate2FA")&&(modalDeactivate2FA=new Vue({name:"modalDeactivate2FA",delimiters:["[[","]]"],el:"#modal-deactivate2FA",data:{userID:0,submitting:!1,msg:"",msgType:"",urls:{deactivate:"/api/users/2fa/deactivate/"}},methods:{setUserData:function(e){this.userID=e},deactivate:function(){this.submitting=!0;var e={userID:this.userID};fetch(post(this.urls.deactivate,e)).then(handleRequestErrors).then(getJSON).then(function(e){if(t=handleAPIErrors(e),t!==""){modalDeactivate2FA.msg=t,modalDeactivate2FA.msgType=msgTypes.danger,modalDeactivate2FA.submitting=!1;return}if(modalDeactivate2FA.msg="2 Factor Authentication is now disabled for this user.",modalDeactivate2FA.msgType=msgTypes.success,document.getElementById("manageUsers")){for(var t,s,n=0,o=manageUsers.users;n<o.length;n++)if(s=o[n],s.ID===modalActivate2FA.userID){s.TwoFactorAuthEnabled=!1;break}}else document.getElementById("userProfile")&&(userProfile.userData.TwoFactorAuthEnabled=!1);setTimeout(function(){$("#modal-deactivate2FA").modal("hide"),modalDeactivate2FA.msg="",modalDeactivate2FA.msgType="",modalDeactivate2FA.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalDeactivate2FA.msg="An unknown error occured. Please try again.",modalDeactivate2FA.msgType=msgTypes.danger,modalDeactivate2FA.submitting=!1})}}}))