var version="2.0.0",msgTypes={danger:"alert-danger",info:"alert-info",success:"alert-success",warning:"alert-warning",primary:"alert-primary"},defaultTimeout=2e3;function isEmail(e){return/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e)}var activityLog,activityLogMaxAvgDurationChart,activityLogRequestsDurationChart,activityOverTimeOfDayChart,enableSetToggleDebug=!1;function setToggle(e,s,t){var a="#"+e;t&&(a="."+e);t=document.querySelectorAll(a);enableSetToggleDebug&&(console.log("**setToggle debugging**"),console.log("  querySelector (given):     ",e),console.log("  querySelector (understood):",a),console.log("  num elements selected:     ",t.length),console.log("  toggle to set on:          ",s)),t.forEach(function(e){e.querySelectorAll(".btn").forEach(function(e){e.classList.remove("active");var t=e.querySelector("input");t.checked=!1,void 0!==s&&(e.dataset.switch===s.toString()?(e.classList.add("active"),t.checked=!0):enableSetToggleDebug&&console.log("  mismatched data-switch:    ",e.dataset.switch,s))})})}function todayPlus(e){var t=new Date,s=new Date(t.setDate(t.getDate()+e)),t=s.getFullYear(),e=s.getMonth()+1,s=s.getDate();return t.toString()+"-"+(e<10?"0"+e.toString():e.toString())+"-"+(s<10?"0"+s.toString():s.toString())}function dateAdd(e,t){var s=e.split("-"),a=parseInt(s[0]),e=parseInt(s[1])-1,s=parseInt(s[2]),e=new Date(a,e,s),s=new Date(e.setDate(e.getDate()+t)),e=s.getFullYear(),t=s.getMonth()+1,s=s.getDate();return e.toString()+"-"+(t<10?"0"+t.toString():t.toString())+"-"+(s<10?"0"+s.toString():s.toString())}function objectToString(t){return Object.keys(t).map(function(e){return e+"="+encodeURIComponent(t[e])}).join("&")}function removeDoubleSlash(e){return e.includes("//")&&console.log("URL contains a double slash, this should be fixed.",e),e=e.replace(/\/\//g,"/")}function get(e,t){return e=(e=removeDoubleSlash(e))+"?"+objectToString(t),new Request(e,{method:"GET",credentials:"same-origin",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}})}function post(e,t){e=removeDoubleSlash(e);var s={method:"POST",credentials:"same-origin",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}},t=objectToString(t);return s.body=t,new Request(e,s)}function postFile(e,t){return e=removeDoubleSlash(e),new Request(e,{method:"POST",credentials:"same-origin",body:t})}function handleRequestErrors(e){return-1==[200,500].indexOf(e.status)?Promise.reject(new Error(e.statusText)):Promise.resolve(e)}function getJSON(e){return e.json()}function handleAPIErrors(e){return!1===e.OK?e.ErrorData.Message:""}document.getElementById("activityLog")&&(activityLog=new Vue({name:"activityLog",delimiters:["[[","]]"],el:"#activityLog",data:{showHelp:!1}})),document.getElementById("activityLogMaxAvgDurationChart")&&(activityLogMaxAvgDurationChart=new Vue({name:"activityLogMaxAvgDurationChart",delimiters:["[[","]]"],el:"#activityLogMaxAvgDurationChart",data:{showHelp:!1,raw:[],chartData:void 0},mounted:function(){this.raw=rawChartData;for(var e=document.getElementById("activity-max-avg-duration-chart"),t=[],s=[],a=[],i=0,n=this.raw;i<n.length;i++){var o=n[i],r=o.Year+"-"+o.Month;t.push(r),s.push(o.AverageTimeDuration),a.push(o.MaxTimeDuration)}this.chartData=new Chart(e,{type:"line",data:{labels:t,datasets:[{label:"Avg. (ms, left)",borderColor:"#007bff",data:s,borderWidth:2,yAxisID:"leftYAxis",fill:!1,lineTension:0},{label:"Max. (ms, right)",borderColor:"#17a2b8",borderWidth:2,borderDash:[5,5],data:a,yAxisID:"rightYAxis",fill:!1,lineTension:0}]},options:{legend:{display:!0},scales:{leftYAxis:{type:"linear",position:"left",ticks:{min:0}},rightYAxis:{type:"linear",position:"right",ticks:{min:0},grid:{display:!1,displayOnChartArea:!1}}},animation:{duration:0}}})}})),document.getElementById("activityLogRequestsDurationChart")&&(activityLogRequestsDurationChart=new Vue({name:"activityLogRequestsDurationChart",delimiters:["[[","]]"],el:"#activityLogRequestsDurationChart",data:{showHelp:!1,raw:[],chartData:void 0},mounted:function(){this.raw=rawChartData;for(var e=document.getElementById("activity-request-duration-chart"),t=[],s=[],a=0,i=this.raw;a<i.length;a++){var n=i[a];t.push(n.DatetimeCreated),s.push(n.TimeDuration)}this.chartData=new Chart(e,{type:"bar",data:{labels:t,datasets:[{label:"Duration (ms)",backgroundColor:"#007bff",data:s,fill:!1,lineTension:0}]},options:{legend:{display:!1},scales:{y:{type:"linear",position:"left",ticks:{min:0,maxTicksLimit:10}}},animation:{duration:0},plugins:{tooltip:{callbacks:{title:function(e){e=e[0].dataIndex,e=activityLogRequestsDurationChart.raw[e];return e.Method+": "+e.URL},label:function(e){e=e.dataIndex,e=activityLogRequestsDurationChart.raw[e];return e.DatetimeCreated+" ("+e.TimeDuration+"ms)"}}}}}})}})),document.getElementById("activityOverTimeOfDayChart")&&(activityOverTimeOfDayChart=new Vue({name:"activityOverTimeOfDayChart",delimiters:["[[","]]"],el:"#activityOverTimeOfDayChart",data:{showHelp:!1,raw:[],chartData:void 0},mounted:function(){this.raw=rawChartData;for(var e=document.getElementById("activity-over-time-of-day-chart"),t=[],s=0,a=this.raw;s<a.length;s++){var i=a[s],i={x:i.HoursDecimal,y:i.Count,hours:i.Hour,minutes:i.Minute};t.push(i)}this.chartData=new Chart(e,{type:"scatter",data:{datasets:[{label:"points",data:t,borderColor:"#007bff"}]},options:{scales:{x:{type:"linear",ticks:{min:0,max:25}}},animation:{duration:0},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){var t=e.datasetIndex,e=activityOverTimeOfDayChart.chartData.data.datasets[t].data[e.dataIndex];return e.y+" @ "+e.hours+":"+(0===parseInt(e.minutes)?"00":e.minutes)+" UTC"}}}}}})}}));var manageAPIKeys,modalAPIKey,manageApp,manageApps,fileFormatYAML="yaml",fileFormatJSON="json",fileFormats=[fileFormatYAML,fileFormatJSON],customFieldTypeInteger="Integer",customFieldTypeDecimal="Decimal",customFieldTypeText="Text",customFieldTypeBoolean="Boolean",customFieldTypeMultiChoice="Multi-Choice",customFieldTypeDate="Date",customFieldTypes=[customFieldTypeInteger,customFieldTypeDecimal,customFieldTypeText,customFieldTypeMultiChoice,customFieldTypeBoolean,customFieldTypeDate],keyPairAlgoECDSAP256="ECDSA (P256)",keyPairAlgoECDSAP384="ECDSA (P384)",keyPairAlgoECDSAP521="ECDSA (P521)",keyPairAlgoRSA2048="RSA (2048-bit)",keyPairAlgoRSA4096="RSA (4096-bit)",keyPairAlgoED25519="ED25519",keyPairAlgoTypes=[keyPairAlgoECDSAP256,keyPairAlgoECDSAP384,keyPairAlgoECDSAP521,keyPairAlgoRSA2048,keyPairAlgoRSA4096,keyPairAlgoED25519];document.getElementById("manageAPIKeys")&&(manageAPIKeys=new Vue({name:"manageAPIKeys",delimiters:["[[","]]"],el:"#manageAPIKeys",data:{keys:[],keysRetrieved:!1,submitting:!1,msg:"",msgType:"",urls:{get:"/api/api-keys/"}},methods:{getKeys:function(){fetch(get(this.urls.get,{})).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return manageAPIKeys.msgLoad=t,void(manageAPIKeys.msgLoadType=msgTypes.danger);manageAPIKeys.keys=e.Data||[],manageAPIKeys.keysRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageAPIKeys.msgLoad="An unknown error occured.  Please try again.",manageAPIKeys.msgLoadType=msgTypes.danger})},passToModal:function(e){modalAPIKey.setModalData(e)}},mounted:function(){""!==this.$el.id&&document.getElementById(this.$el.id)&&this.getKeys()}})),document.getElementById("modal-apiKey")&&(modalAPIKey=new Vue({name:"modalAPIKey",delimiters:["[[","]]"],el:"#modal-apiKey",data:{keyData:{},keyGeneratedSuccessfully:!1,submitting:!1,msg:"",msgType:"",urls:{generate:"/api/api-keys/generate/",revoke:"/api/api-keys/revoke/"}},computed:{adding:function(){return void 0===this.keyData.ID||this.keyData.ID<1}},methods:{setModalData:function(e){this.resetModal(),void 0!==e&&(this.keyData=e)},resetModal:function(){this.keyData={},this.keyGeneratedSuccessfully=!1,this.submitting=!1,this.msg=""},generate:function(){var e;this.submitting?console.log("already submitting"):(this.msgType=msgTypes.danger,""!==this.keyData.Description?this.submitting?console.log("already submitting..."):(this.msgType=msgTypes.primary,this.msg="Generating...",this.keyGeneratedSuccessfully=!1,this.keyData.K="",this.submitting=!0,e={data:JSON.stringify(this.keyData)},fetch(post(this.urls.generate,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return modalAPIKey.msg=t,modalAPIKey.msgType=msgTypes.danger,void(modalAPIKey.submitting=!1);modalAPIKey.msg="",modalAPIKey.key=e.Data,modalAPIKey.keyGeneratedSuccessfully=!0,manageAPIKeys.getKeys(),setTimeout(function(){modalAPIKey.resetModal()},6e4),modalAPIKey.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalAPIKey.msg="An unknown error occured.  Please try again.",modalAPIKey.msgType=msgTypes.danger,modalAPIKey.submitting=!1})):this.msg="You must provide a description for this API key so you can recognize what it is used for.")},revoke:function(){if(this.submitting)console.log("already submitting");else{if(this.keyData.ID<1)return this.msg="Could not determine which API key to revoke",void(this.msgType=msgTypes.danger);this.msg="Revoking...",this.msgType=msgTypes.primary,this.submitting=!0;var e={id:this.keyData.ID};fetch(post(this.urls.revoke,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return manageAPIKeys.msg=e,manageAPIKeys.msgType=msgTypes.danger,void(manageAPIKeys.submitting=!1);manageAPIKeys.getKeys(),manageAPIKeys.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageAPIKeys.msgSave="An unknown error occured.  Please try again.",manageAPIKeys.msgSaveType=msgTypes.danger,manageAPIKeys.submitting=!1})}}}})),document.getElementById("manageApp")&&(manageApp=new Vue({name:"manageApp",delimiters:["[[","]]"],el:"#manageApp",data:{settings:{},submitting:!1,msg:"",msgType:"",urls:{get:"/api/app-settings/",save:"/api/app-settings/update/"}},methods:{getData:function(){fetch(get(this.urls.get,{})).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return manageApp.msg=t,void(manageApp.msgType=msgTypes.danger);manageApp.settings=e.Data,Vue.nextTick(function(){for(var e in manageApp.settings)"ID"!==e&&"DatetimeModified"!==e&&setToggle(e,manageApp.settings[e])})}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApp.msgSettings="An unknown error occured.  Please try again.",manageApp.msgSettingsType=msgTypes.danger})},save:function(){var e;this.submitting?console.log("already submitting..."):(this.msg="Saving...",this.msgType=msgTypes.primary,this.submitting=!0,e={data:JSON.stringify(this.settings)},fetch(post(this.urls.save,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return manageApp.msg=e,manageApp.msgType=msgTypes.danger,void(manageApp.submitting=!1);manageApp.msg="Changes saved!",manageApp.msgType=msgTypes.success,setTimeout(function(){manageApp.msg="",manageApp.msgType=""},defaultTimeout),manageApp.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApp.msg="An unknown error occured.  Please try again.",manageApp.msgType=msgTypes.danger,manageApp.submitting=!1}))},setField:function(e,t){this.settings[e]=t}},mounted:function(){this.getData()}})),document.getElementById("manageApps")&&(manageApps=new Vue({name:"manageApps",delimiters:["[[","]]"],el:"#manageApps",data:{addingNew:!1,apps:[],appsRetrieved:!1,msgLoad:"",msgLoadType:"",fileFormats:fileFormats,defaultFileFormat:fileFormatYAML,appSelectedID:0,appData:{},submitting:!1,msgSave:"",msgSaveType:"",urls:{get:"/api/apps/",add:"/api/apps/add/",update:"/api/apps/update/"}},computed:{addEditCardTitle:function(){return this.addingNew?"Add App":"Edit App"}},methods:{setField:function(e,t){this.appData[e]=t},resetForm:function(){this.appData={Name:"",DaysToExpiration:365,FileFormat:this.defaultFileFormat,DownloadFilename:"",ShowLicenseID:!0,ShowAppName:!0,Active:!0},Vue.nextTick(function(){setToggle("ShowLicenseID",!0),setToggle("ShowAppName",!0),setToggle("Active",!0)}),this.appSelectedID=0,this.msgSave="",this.msgSaveType=""},setUIState:function(){this.addingNew?this.addingNew=!1:(this.addingNew=!0,this.resetForm(),this.deselectApp())},getApps:function(){fetch(get(this.urls.get,{})).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return manageApps.msgLoad=t,void(manageApps.msgLoadType=msgTypes.danger);manageApps.apps=e.Data||[],manageApps.appsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApps.msgLoad="An unknown error occured. Please try again.",manageApps.msgLoadType=msgTypes.danger})},showApp:function(){if(!(this.appSelectedID<1))for(var t=this,e=0,s=this.apps;e<s.length;e++){var a=function(e){return e.ID!==t.appSelectedID?"continue":(t.appData=e,Vue.nextTick(function(){setToggle("ShowLicenseID",e.ShowLicenseID),setToggle("ShowAppName",e.ShowAppName),setToggle("Active",e.Active)}),t.setAppInOtherVueObjects(t.appSelectedID),{value:void 0})}(s[e]);if("object"==typeof a)return a.value}},setAppInOtherVueObjects:function(e){listKeyPairs.setAppID(e),modalKeyPair.setAppID(e),listCustomFieldsDefined.setAppID(e),modalCustomFieldDefined.setAppID(e)},deselectApp:function(){this.setAppInOtherVueObjects(0)},setDefaultDownloadFilename:function(){var e;""!==this.appData.Name.trim()&&""===this.appData.DownloadFilename.trim()&&(e=this.appData.Name.trim().replace(/ /g,"_"),this.appData.DownloadFilename=e.toLowerCase()+".txt")},addOrUpdate:function(){this.msgSaveType=msgTypes.danger,""!==this.appData.Name.trim()?this.appData.DaysToExpiration<0?this.msgSave="The default license period cannot be less than 0 days.":this.fileFormats.includes(this.appData.FileFormat.trim())?""!==this.appData.DownloadFilename.trim()?void 0!==this.appData.ID?this.update():this.add():this.msgSave="You must provide the filename your licenses for this app will be downloaded as.":this.msgSave="Please choose a file format from the provided options.":this.msgSave="You must provide the name for your app."},add:function(){var e;this.submitting?console.log("already submitting..."):(this.msgSave="Adding...",this.msgSaveType=msgTypes.primary,this.submitting=!0,e={data:JSON.stringify(this.appData)},fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return manageApps.msgSave=t,manageApps.msgSaveType=msgTypes.danger,void(manageApps.submitting=!1);manageApps.getApps(),manageApps.msgSave="Added! Make sure you add the necessary key pairs and custom fields!",manageApps.msgSaveType=msgTypes.success,setTimeout(function(){manageApps.appSelectedID=e.Data,manageApps.showApp(),manageApps.setUIState(),manageApps.msgSave="",manageApps.msgLoadType="",manageApps.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApps.msgSave="An unknown error occured. Please try again.",manageApps.msgSaveType=msgTypes.danger,manageApps.submitting=!1}))},update:function(){if(this.submitting)console.log("already submitting...");else{if(isNaN(this.appData.ID)||""===this.appData.ID||this.appData.ID<1)return this.msgSave="Could not determine which app you are trying to update. Please refresh the page and try again.",void(this.msgSaveType=msgTypes.danger);this.msgSave="Saving...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.appData)};fetch(post(this.urls.update,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return manageApps.msgSave=e,manageApps.msgSaveType=msgTypes.danger,void(manageApps.submitting=!1);manageApps.msgSave="Changes saved!",manageApps.msgSaveType=msgTypes.success,setTimeout(function(){manageApps.msgSave="",manageApps.msgSaveType="",manageApps.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageApps.msgSave="An unknown error occured. Please try again.",manageApps.msgSaveType=msgTypes.danger,manageApps.submitting=!1})}}},mounted:function(){this.getApps()}}));var createLicense,listCustomFieldsDefined,modalCustomFieldDefined,headerBtns,listKeyPairs,modalKeyPair,licenses,login,manageLicense,modalDisableLicense,modalNote,modalRenewLicense,manageUsers,modalChangePassword,modalActivate2FA,modalDeactivate2FA,bsTooltip=function(e,t){var s,a=[];t.modifiers.focus&&a.push("focus"),t.modifiers.hover&&a.push("hover"),t.modifiers.click&&a.push("click"),a.length||a.push("hover"),void 0!==t.value&&(s=!1,e.dataset.html&&(s=!0),$(e).tooltip({title:t.value,placement:t.arg||"top",trigger:a.join(" "),html:s}))};Vue.directive("tooltip",{bind:bsTooltip,update:bsTooltip,unbind:function(e){$(e).tooltip("dispose")}}),document.getElementById("createLicense")&&(createLicense=new Vue({name:"createLicense",delimiters:["[[","]]"],el:"#createLicense",data:{apps:[],appsRetrieved:!1,appSelectedID:0,keyPairs:[],keyPairsRetrieved:!1,fields:[],fieldsRetrieved:!1,customFieldTypeInteger:customFieldTypeInteger,customFieldTypeDecimal:customFieldTypeDecimal,customFieldTypeText:customFieldTypeText,customFieldTypeBoolean:customFieldTypeBoolean,customFieldTypeMultiChoice:customFieldTypeMultiChoice,customFieldTypeDate:customFieldTypeDate,separator:";",licenseData:{KeyPairID:0,CompanyName:"ACME Dynamite",ContactName:"Wyle E Coyote",PhoneNumber:"123-555-1212",Email:"wyle@example.com",ExpireDate:""},submitting:!1,msg:"",msgType:"",urls:{getApps:"/api/apps/",getKeyPairs:"/api/key-pairs/",getCustomFields:"/api/custom-fields/defined/",add:"/api/licenses/add/",getAPIKeys:"/api/api-keys/"},showAPIBuilder:!1,returnLicenseFile:!1,apiKeys:[],apiKeysRetrieved:!1,apiBuilderMsg:"",apiBuilderMsgType:"",apiKeySelected:""},methods:{setField:function(e,t){this.fields[e].BoolValue=t},getApps:function(){fetch(get(this.urls.getApps,{})).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return createLicense.msg=t,void(createLicense.msgType=msgTypes.danger);createLicense.apps=e.Data||[],createLicense.appsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.msg="An unknown error occured. Please try again.",createLicense.msgType=msgTypes.danger})},getKeyPairs:function(){var e={appID:this.appSelectedID,activeOnly:!0};fetch(get(this.urls.getKeyPairs,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return createLicense.msg=t,void(createLicense.msgType=msgTypes.danger);createLicense.keyPairs=e.Data||[],createLicense.keyPairsRetrieved=!0;for(var s=0,a=createLicense.keyPairs;s<a.length;s++){var i=a[s];if(i.IsDefault){createLicense.licenseData.KeyPairID=i.ID;break}}}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.msg="An unknown error occured. Please try again.",createLicense.msgType=msgTypes.danger})},getCustomFields:function(){var e={appID:this.appSelectedID,activeOnly:!0};fetch(get(this.urls.getCustomFields,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return createLicense.msgLoad=t,void(createLicense.msgLoadType=msgTypes.danger);createLicense.fields=e.Data||[],createLicense.fieldsRetrieved=!0;for(var s=0,a=createLicense.fields;s<a.length;s++)!function(e){switch(e.Type){case customFieldTypeInteger:e.IntegerValue=e.IntegerDefaultValue;break;case customFieldTypeDecimal:e.DecimalValue=e.DecimalDefaultValue;break;case customFieldTypeText:e.TextValue=e.TextDefaultValue;break;case customFieldTypeBoolean:e.BoolValue=e.BoolDefaultValue,Vue.nextTick(function(){setToggle("cf_bool_id_"+e.ID.toString(),e.BoolDefaultValue)});break;case customFieldTypeMultiChoice:e.MultiChoiceValue=e.MultiChoiceDefaultValue;break;case customFieldTypeDate:e.DateValue=todayPlus(e.DateDefaultIncrement)}}(a[s])}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.msgLoad="An unknown error occured.  Please try again.",createLicense.msgLoadType=msgTypes.danger})},setExpireDate:function(){for(var e=0,t=this.apps;e<t.length;e++){var s=t[e];if(s.ID===this.appSelectedID){this.licenseData.ExpireDate=todayPlus(s.DaysToExpiration);break}}},todayPlusOne:function(){return todayPlus(1)},today:function(){var e=new Date,t=e.getFullYear(),s=e.getMonth()+1,e=e.getDate();return t.toString()+"-"+(s<10?"0"+s.toString():s.toString())+"-"+(e<10?"0"+e.toString():e.toString())},create:function(){if(this.msgType=msgTypes.danger,this.appSelectedID<1)this.msg="You must choose an app.";else if(this.licenseData.KeyPairID<1)this.msg="You must choose a key pair.";else if(""!==this.licenseData.CompanyName.trim())if(""!==this.licenseData.ContactName.trim())if(""!==this.licenseData.PhoneNumber.trim())if(""!==this.licenseData.Email.trim())if(isEmail(this.licenseData.Email))if(""!==this.licenseData.ExpireDate.trim()){for(var e,t=0;t<this.fields.length;t++){var s=this.fields[t];switch(s.Type){case customFieldTypeInteger:if(isNaN(s.IntegerValue)||NaN===parseInt(s.IntegerValue.toString())||!Number.isInteger(s.IntegerValue))return void(this.msg="You must provide an integer for the "+s.Name+" field.");if(s.IntegerValue<s.NumberMinValue||s.IntegerValue>s.NumberMaxValue)return void(this.msg="The value for the "+s.Name+" field must be an integer between "+s.NumberMinValue.toFixed(0)+" and "+s.NumberMaxValue.toFixed(0)+".");break;case customFieldTypeDecimal:if(isNaN(s.DecimalValue)||NaN===parseInt(s.DecimalValue.toString()))return void(this.msg="You must provide an number for the "+s.Name+" field.");if(s.DecimalValue<s.NumberMinValue||s.DecimalValue>s.NumberMaxValue)return void(this.msg="The value for the "+s.Name+" field must be an number between "+s.NumberMinValue.toFixed(2)+" and "+s.NumberMaxValue.toFixed(2)+".");break;case customFieldTypeText:case customFieldTypeBoolean:break;case customFieldTypeMultiChoice:if(!s.MultiChoiceOptions.split(this.separator).includes(s.MultiChoiceValue))return void(this.msg="You must choose a value for the "+s.Name+" field.");break;case customFieldTypeDate:if(""===s.DateValue.trim())return void(this.msg="You must choose a date for the "+s.Name+"field.")}0!==s.CustomFieldDefinedID&&0<s.ID&&(s.CustomFieldDefinedID=s.ID,s.ID=0),s.CreatedByUserID=0,s.DatetimeCreated="",s.DatetimeModified=""}this.submitting?console.log("already submitting..."):(this.msg="Saving...",this.msgType=msgTypes.primary,this.submitting=!0,e={licenseData:JSON.stringify(this.licenseData),customFields:JSON.stringify(this.fields)},fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return createLicense.msg=t,createLicense.msgType=msgTypes.danger,void(createLicense.submitting=!1);var s=e.Data;if(void 0===s)return createLicense.msg="Could not determine where to redirect you. This is an odd error...",void(createLicense.msgType=msgTypes.warning);createLicense.msg="License created! Redirecting to license...",createLicense.msgType=msgTypes.primary,setTimeout(function(){window.location.href="/license/?id="+s},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.msg="An unknown error occured. Please try again.",createLicense.msgType=msgTypes.danger,createLicense.submitting=!1}))}else this.msg="You must provide an expiration date for the license.";else this.msg="The email address you provided is not valid.";else this.msg="You must provide an email address.";else this.msg="You must provide a phone number.";else this.msg="You must provide the contact name of who requested this license.";else this.msg="You must provide the company name for which this license is for."},getAPIKeys:function(){this.apiKeysRetrieved||fetch(get(this.urls.getAPIKeys,{})).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return createLicense.apiBuilderMsg=t,void(createLicense.apiBuilderMsgType=msgTypes.danger);createLicense.apiKeys=e.Data||[],createLicense.apiKeysRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),createLicense.apiBuilderMsg="An unknown error occured.  Please try again.",createLicense.apiBuilderMsgType=msgTypes.danger})}},computed:{getAPIRequestFieldsObject:function(){for(var e={},t=0,s=this.fields;t<s.length;t++){var a=s[t];switch(a.Type){case customFieldTypeInteger:e[a.Name]=a.IntegerValue;break;case customFieldTypeDecimal:e[a.Name]=a.DecimalValue;break;case customFieldTypeText:e[a.Name]=a.TextValue;break;case customFieldTypeBoolean:e[a.Name]=a.BoolValue;break;case customFieldTypeMultiChoice:e[a.Name]=a.MultiChoiceValue;break;case customFieldTypeDate:e[a.Name]=a.DateValue}}return e},showAPIRequest:function(){if(!(this.appSelectedID<1||this.licenseData.KeyPairID<1)&&this.fieldsRetrieved){var e=window.location.protocol,t=window.location.host,s=encodeURIComponent(JSON.stringify(this.getAPIRequestFieldsObject)),s=["curl '"+e+"//"+t+"/api/v1/licenses/add/'","-X POST","-H 'Content-type: application/x-www-form-urlencoded'","-d apiKey='"+this.apiKeySelected+"'","-d appID='"+this.appSelectedID+"'","-d keyPairID='"+this.licenseData.KeyPairID+"'","-d companyName='"+this.licenseData.CompanyName+"'","-d contactName='"+this.licenseData.ContactName+"'","-d phoneNumber='"+this.licenseData.PhoneNumber+"'","-d email='"+this.licenseData.Email+"'","-d expireDate='"+this.licenseData.ExpireDate+"'","-d fields="+s];return this.returnLicenseFile&&s.push("-d returnLicenseFile=true"),s.join(" \\\n")}}},mounted:function(){this.getApps(),setToggle("returnLicenseFile",!1)}})),document.getElementById("listCustomFieldsDefined")&&(listCustomFieldsDefined=new Vue({name:"listCustomFieldsDefined",delimiters:["[[","]]"],el:"#listCustomFieldsDefined",data:{appSelectedID:0,fields:[],fieldsRetrieved:!1,customFieldTypeInteger:customFieldTypeInteger,customFieldTypeDecimal:customFieldTypeDecimal,customFieldTypeText:customFieldTypeText,customFieldTypeBoolean:customFieldTypeBoolean,customFieldTypeMultiChoice:customFieldTypeMultiChoice,customFieldTypeDate:customFieldTypeDate,msgLoad:"",msgLoadType:"",collapseUI:!1,urls:{get:"/api/custom-fields/defined/"}},methods:{setAppID:function(e){if(0===(this.appSelectedID=e))return this.fields=[],void(this.msgLoad="");this.getCustomFields()},getCustomFields:function(){var e={appID:this.appSelectedID,activeOnly:!0};fetch(get(this.urls.get,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return listCustomFieldsDefined.msgLoad=t,void(listCustomFieldsDefined.msgLoadType=msgTypes.danger);listCustomFieldsDefined.fields=e.Data||[],listCustomFieldsDefined.fieldsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),listCustomFieldsDefined.msgLoad="An unknown error occured. Please try again.",listCustomFieldsDefined.msgLoadType=msgTypes.danger})},passToModal:function(e){modalCustomFieldDefined.setModalData(e)}}})),document.getElementById("modal-customFieldDefined")&&(modalCustomFieldDefined=new Vue({name:"modalCustomFieldDefined",delimiters:["[[","]]"],el:"#modal-customFieldDefined",data:{appSelectedID:0,fieldData:{},customFieldTypes:customFieldTypes,customFieldTypeInteger:customFieldTypeInteger,customFieldTypeDecimal:customFieldTypeDecimal,customFieldTypeText:customFieldTypeText,customFieldTypeBoolean:customFieldTypeBoolean,customFieldTypeMultiChoice:customFieldTypeMultiChoice,customFieldTypeDate:customFieldTypeDate,separator:";",submitting:!1,msgSave:"",msgSaveType:"",urls:{add:"/api/custom-fields/defined/add/",update:"/api/custom-fields/defined/update/",delete:"/api/custom-fields/defined/delete/"}},computed:{adding:function(){return void 0===this.fieldData.ID||this.fieldData.ID<1},multiChoiceOptions:function(){if(void 0===this.fieldData.MultiChoiceOptions)return[];if(this.fieldData.Type!==this.customFieldTypeMultiChoice)return[];if(0===this.fieldData.MultiChoiceOptions.trim().length)return[];for(var e=[],t=0,s=this.fieldData.MultiChoiceOptions.split(this.separator);t<s.length;t++){var a=s[t];""!==(a=a.trim())&&(e.includes(a)||e.push(a))}return e}},methods:{setAppID:function(e){this.appSelectedID=e},setModalData:function(e){this.resetModal(),void 0!==e&&(this.fieldData=e).Type===this.customFieldTypeBoolean&&Vue.nextTick(function(){setToggle("BoolDefaultValue",e.BoolDefaultValue)})},resetModal:function(){this.fieldData={ID:void 0,DatetimeCreated:"",DatetimeModified:"",CreatedByUserID:0,Active:!0,AppID:this.appSelectedID,Name:"",Type:"",Instructions:"",IntegerDefaultValue:0,DecimalDefaultValue:0,TextDefaultValue:"",BoolDefaultValue:!1,MultiChoiceDefaultValue:"",DateDefaultIncrement:0,NumberMinValue:0,NumberMaxValue:0,MultiChoiceOptions:""},this.submitting=!1,this.msgSave="",this.msgSaveType=""},setField:function(e,t){this.fieldData[e]=t},setToggleDefaultIfBool:function(){Vue.nextTick(function(){setToggle("BoolDefaultValue",modalCustomFieldDefined.fieldData.BoolDefaultValue)})},addOrUpdate:function(){if(this.msgSaveType=msgTypes.danger,""!==this.fieldData.Name.trim()){switch(this.fieldData.Type){case customFieldTypeInteger:if(void 0===this.fieldData.NumberMinValue||void 0===this.fieldData.NumberMaxValue)return void(this.msgSave="You must provide both the minimum and maximum value for the numbers you allow in this field.");if(!Number.isInteger(this.fieldData.NumberMinValue)||!Number.isInteger(this.fieldData.NumberMinValue))return void(this.msgSave="The minimum and maximum values must be integers (no decimals).");if(this.fieldData.NumberMinValue>=this.fieldData.NumberMaxValue)return void(this.msgSave="The minimum value must be less than the maximum.");if(void 0===this.fieldData.IntegerDefaultValue)return void(this.msgSave="You must provide a default value for this field.");if(!Number.isInteger(this.fieldData.IntegerDefaultValue))return void(this.msgSave="The default must be an integer (no decimals).");if(this.fieldData.IntegerDefaultValue<this.fieldData.NumberMinValue||this.fieldData.IntegerDefaultValue>this.fieldData.NumberMaxValue)return void(this.msgSave="The default value must be within the minimum to maximum range.");break;case customFieldTypeDecimal:if(void 0===this.fieldData.NumberMinValue||void 0===this.fieldData.NumberMaxValue)return void(this.msgSave="You must provide both the minimum and maximum value for the numbers you allow in this field.");if(this.fieldData.NumberMinValue>=this.fieldData.NumberMaxValue)return void(this.msgSave="The minimum value must be less than the maximum.");if(void 0===this.fieldData.DecimalDefaultValue)return void(this.msgSave="You must provide a default value for this field.");if(this.fieldData.DecimalDefaultValue<this.fieldData.NumberMinValue||this.fieldData.DecimalDefaultValue>this.fieldData.NumberMaxValue)return void(this.msgSave="The default value must be within the minimum to maximum range.");break;case customFieldTypeText:if(void 0===this.fieldData.TextDefaultValue||""===this.fieldData.TextDefaultValue.trim())return void(this.msgSave="You must provide a default value for this field.");break;case customFieldTypeBoolean:if(void 0===this.fieldData.BoolDefaultValue||!0!==this.fieldData.BoolDefaultValue&&!1!==this.fieldData.BoolDefaultValue)return void(this.msgSave="You must choose a default value for this field.");break;case customFieldTypeMultiChoice:if(void 0===this.fieldData.MultiChoiceOptions||""===this.fieldData.MultiChoiceOptions)return void(this.msgSave="You must provide at least one option.");for(var e=[],t=0,s=this.fieldData.MultiChoiceOptions.split(this.separator);t<s.length;t++){var a=s[t];if(""!==(a=a.trim())){if(e.includes(a))return void(this.msgSave='The option "'+a+'" is included more than once. Please remove the duplicate(s).');e.push(a)}}if(0===e.length)return void(this.msgSave="You must provide as least one option for this field.");if(void 0===this.fieldData.MultiChoiceDefaultValue||""===this.fieldData.MultiChoiceDefaultValue.trim())return void(this.msgSave="You must choose a default value for this field.");if(!e.includes(this.fieldData.MultiChoiceDefaultValue))return void(this.msgSave="Please choose a default value from the list of options your provided.");this.fieldData.MultiChoiceOptions=e.join(this.separator);break;case customFieldTypeDate:if(void 0===this.fieldData.DateDefaultIncrement||this.fieldData.DateDefaultIncrement<0)return void(this.msgSave="Please provide the number of days from the date the license is created to calculate the date set for this field.");break;default:return void(this.msgSave="Please choose an field type from the provided options.")}void 0!==this.fieldData.ID?this.update():this.add()}else this.msgSave="You must provide a name for this field."},add:function(){var e;this.submitting?console.log("already submitting..."):(this.msgSave="Adding...",this.msgSaveType=msgTypes.primary,this.submitting=!0,e={data:JSON.stringify(this.fieldData)},fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalCustomFieldDefined.msgSave=e,modalCustomFieldDefined.msgSaveType=msgTypes.danger,void(modalCustomFieldDefined.submitting=!1);listCustomFieldsDefined.getCustomFields(),modalCustomFieldDefined.msgSave="Added!",modalCustomFieldDefined.msgSaveType=msgTypes.success,setTimeout(function(){modalCustomFieldDefined.resetModal(),modalCustomFieldDefined.msgSave="",modalCustomFieldDefined.msgSaveType="",modalCustomFieldDefined.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalCustomFieldDefined.msgSave="An unknown error occured. Please try again.",modalCustomFieldDefined.msgSaveType=msgTypes.danger,modalCustomFieldDefined.submitting=!1}))},update:function(){if(this.submitting)console.log("already submitting...");else{if(isNaN(this.fieldData.ID)||""===this.fieldData.ID||this.fieldData.ID<1)return this.msgSave="Could not determine which field you are trying to update. Please refresh the page and try again.",void(this.msgSaveType=msgTypes.danger);this.msgSave="Saving...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.fieldData)};fetch(post(this.urls.update,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalCustomFieldDefined.msgSave=e,modalCustomFieldDefined.msgSaveType=msgTypes.danger,void(modalCustomFieldDefined.submitting=!1);modalCustomFieldDefined.msgSave="Changes saved!",modalCustomFieldDefined.msgSaveType=msgTypes.success,setTimeout(function(){modalCustomFieldDefined.msgSave="",modalCustomFieldDefined.msgSaveType="",modalCustomFieldDefined.submitting=!1},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalCustomFieldDefined.msgSave="An unknown error occured. Please try again.",modalCustomFieldDefined.msgSaveType=msgTypes.danger,modalCustomFieldDefined.submitting=!1})}},remove:function(){if(this.submitting)console.log("already submitting...");else{if(isNaN(this.fieldData.ID)||""===this.fieldData.ID||this.fieldData.ID<1)return this.msgSave="Could not determine which field you are trying to delete. Please refresh the page and try again.",void(this.msgSaveType=msgTypes.danger);this.msgSave="Deleting...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={id:this.fieldData.ID};fetch(post(this.urls.delete,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalCustomFieldDefined.msgSave=e,void(modalCustomFieldDefined.msgSaveType=msgTypes.danger);listCustomFieldsDefined.getCustomFields(),modalCustomFieldDefined.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalCustomFieldDefined.msgSave="An unknown error occured. Please try again.",modalCustomFieldDefined.msgSaveType=msgTypes.danger,modalCustomFieldDefined.submitting=!1})}}},mounted:function(){this.resetModal()}})),document.getElementById("headerBtns")&&(headerBtns=new Vue({name:"headerBtns",delimiters:["[[","]]"],el:"#headerBtns",data:{usernameHovered:!1}})),document.getElementById("listKeyPairs")&&(listKeyPairs=new Vue({name:"listKeyPairs",delimiters:["[[","]]"],el:"#listKeyPairs",data:{appSelectedID:0,keyPairs:[],keyPairsRetrieved:!1,msgLoad:"",msgLoadType:"",collapseUI:!1,urls:{get:"/api/key-pairs/"}},methods:{setAppID:function(e){if(0===(this.appSelectedID=e))return this.keyPairs=[],void(this.msgLoad="");this.getKeyPairs()},getKeyPairs:function(){var e={appID:this.appSelectedID,activeOnly:!0};fetch(get(this.urls.get,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return listKeyPairs.msgLoad=t,void(listKeyPairs.msgLoadType=msgTypes.danger);listKeyPairs.keyPairs=e.Data||[],listKeyPairs.keyPairsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),listKeyPairs.msgLoad="An unknown error occured. Please try again.",listKeyPairs.msgLoadType=msgTypes.danger})},passToModal:function(e){modalKeyPair.setModalData(e)}}})),document.getElementById("modal-keyPair")&&(modalKeyPair=new Vue({name:"modalKeyPair",delimiters:["[[","]]"],el:"#modal-keyPair",data:{appSelectedID:0,keyPairData:{},algorithmTypes:keyPairAlgoTypes,defaultAlgorithmType:keyPairAlgoED25519,showPublicKey:!1,submitting:!1,msgSave:"",msgSaveType:"",urls:{add:"/api/key-pairs/add/",delete:"/api/key-pairs/delete/",setDefault:"/api/key-pairs/set-default/"}},computed:{adding:function(){return void 0===this.keyPairData.ID||this.keyPairData.ID<1},publicKeyNumLines:function(){return void 0===this.keyPairData.PublicKey||""===this.keyPairData.PublicKey.trim()?2:this.keyPairData.PublicKey.split("\n").length}},methods:{setAppID:function(e){this.appSelectedID=e},setModalData:function(e){this.resetModal(),void 0!==e&&(this.keyPairData=e)},resetModal:function(){this.keyPairData={ID:0,DatetimeCreated:"",DatetimeModified:"",CreatedByUserID:0,Active:!0,AppID:this.appSelectedID,Name:"",AlgorithmType:this.defaultAlgorithmType,PublicKey:"",IsDefault:!1},this.showPublicKey=!1,this.submitting=!1,this.msgSave="",this.msgSaveType=""},add:function(){var e;this.submitting?console.log("already submitting..."):(this.msgSaveType=msgTypes.danger,""!==this.keyPairData.Name.trim()?this.algorithmTypes.includes(this.keyPairData.AlgorithmType)?(this.msgSave="Generating key pair...",this.msgSaveType=msgTypes.primary,this.submitting=!0,e={data:JSON.stringify(this.keyPairData)},fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return modalKeyPair.msgSave=t,modalKeyPair.msgSaveType=msgTypes.danger,void(modalKeyPair.submitting=!1);modalKeyPair.keyPairData=e.Data,listKeyPairs.getKeyPairs(),modalKeyPair.msgSave="Added!",modalKeyPair.msgSaveType=msgTypes.success,modalKeyPair.submitting=!1,setTimeout(function(){modalKeyPair.msgSave="",modalKeyPair.msgSaveType=""},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalKeyPair.msgSave="An unknown error occured.  Please try again.",modalKeyPair.msgSaveType=msgTypes.danger,modalKeyPair.submitting=!1})):this.msgSave="Please choose an algorithm from the provided options":this.msgSave="You must provide a name for this key pair.")},remove:function(){if(this.submitting)console.log("already submitting...");else{if(isNaN(this.keyPairData.ID)||""===this.keyPairData.ID||this.keyPairData.ID<1)return this.msgSave="Could not determine which key pair you are trying to delete. Please refresh the page and try again.",void(this.msgSaveType=msgTypes.danger);this.msgSave="Deleting...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={id:this.keyPairData.ID};fetch(post(this.urls.delete,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalKeyPair.msgSave=e,void(modalKeyPair.msgSaveType=msgTypes.danger);listKeyPairs.getKeyPairs(),modalKeyPair.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalKeyPair.msgSave="An unknown error occured. Please try again.",modalKeyPair.msgSaveType=msgTypes.danger,modalKeyPair.submitting=!1})}},setDefault:function(){if(this.submitting)console.log("already submitting...");else{if(isNaN(this.keyPairData.ID)||""===this.keyPairData.ID||this.keyPairData.ID<1)return this.msgSave="Could not determine which key pair you want to set as default. Please refresh the page and try again.",void(this.msgSaveType=msgTypes.danger);this.msgSave="Setting default...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={id:this.keyPairData.ID};fetch(post(this.urls.setDefault,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalKeyPair.msgSave=e,void(modalKeyPair.msgSaveType=msgTypes.danger);listKeyPairs.getKeyPairs(),modalKeyPair.keyPairData.IsDefault=!0,modalKeyPair.submitting=!1,modalKeyPair.msgSave=""}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalKeyPair.msgSave="An unknown error occured. Please try again.",modalKeyPair.msgSaveType=msgTypes.danger,modalKeyPair.submitting=!1})}}},mounted:function(){this.resetModal()}})),document.getElementById("licenses")&&(licenses=new Vue({name:"licenses",delimiters:["[[","]]"],el:"#licenses",data:{apps:[],appsRetrieved:!1,appSelectedID:0,rowLimit:20,activeOnly:!1,licenses:[],licensesRetrieved:!1,submitting:!1,msg:"",msgType:"",urls:{getApps:"/api/apps/",getLicenses:"/api/licenses/"}},methods:{getApps:function(){fetch(get(this.urls.getApps,{activeOnly:!0})).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return licenses.msgLoad=t,void(licenses.msgLoadType=msgTypes.danger);licenses.apps=e.Data||[],licenses.appsRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),licenses.msgLoad="An unknown error occured. Please try again.",licenses.msgLoadType=msgTypes.danger})},getLicenses:function(){this.appSelectedID<0&&(this.appSelectedID=0);var e={appID:this.appSelectedID,limit:this.rowLimit,activeOnly:this.activeOnly};fetch(get(this.urls.getLicenses,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return licenses.msgLoad=t,void(licenses.msgLoadType=msgTypes.danger);licenses.licenses=e.Data||[],licenses.licensesRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),licenses.msgLoad="An unknown error occured.  Please try again.",licenses.msgLoadType=msgTypes.danger})}},mounted:function(){this.getApps(),this.getLicenses()}})),document.getElementById("login")&&(login=new Vue({name:"login",delimiters:["[[","]]"],el:"#login",data:{username:"admin@example.com",password:"admin@example.com",msg:"",msgType:"",submitting:!1,show2FAInput:!1,twoFAVerificationCode:"",urls:{loginAuth:"/login/",mainApp:"/app/"}},methods:{login:function(){if(this.submitting)console.log("already submitting...");else if(0!==this.username.length){if(!1===isEmail(this.username))return this.msg="You must provide an email address as a username.",void(this.msgType=msgTypes.danger);if(0===this.password.length)return this.msg="You must provide a password.",void(this.msgType=msgTypes.danger);if(this.show2FAInput&&6!==this.twoFAVerificationCode.length)return this.msg="Your 2FA code must be exactly 6 numeric characters.",void(this.msgType=msgTypes.danger);this.msg="Logging in...",this.msgType=msgTypes.primary,this.submitting=!0;var e={username:this.username,password:this.password,twoFAToken:this.twoFAVerificationCode};fetch(post(this.urls.loginAuth,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return login.msg=t,void(login.msgType=msgTypes.danger);e=e.Type;"login2FATokenRequired"===e?(login.show2FAInput=!0,login.msg="",Vue.nextTick(function(){document.getElementById("token").focus()})):"login2FAForced"===e?(login.msg="2 Factor Authentication (2FA) is required but you do not have it set up.  Please see an administator to set up 2FA.",login.msgType=msgTypes.danger):"loginOK"===e?window.location.href=login.urls.mainApp:(console.log("unhandled or invalid login response:",e),login.msg="An unknown error occured.  Please contact an administator.",login.msgType=msgTypes.danger)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),login.msg="An unknown error occured.  Please try again.",login.msgType=msgTypes.danger}),this.submitting=!1}}},mounted:function(){""!==this.$el.id&&document.getElementById(this.$el.id)&&document.getElementById("username").focus()}})),document.getElementById("manageLicense")&&(manageLicense=new Vue({name:"manageLicense",delimiters:["[[","]]"],el:"#manageLicense",data:{licenseID:0,licenseData:{},licenseDataRetrieved:!1,customFieldResults:[],downloadHistory:[],notes:[],msgLicenseData:"",msgLicenseDataType:"",msgHistory:"",msgHistoryType:"",msgNotes:"",msgNotesType:"",showAdvancedInfo:!1,customFieldTypeInteger:customFieldTypeInteger,customFieldTypeDecimal:customFieldTypeDecimal,customFieldTypeText:customFieldTypeText,customFieldTypeBoolean:customFieldTypeBoolean,customFieldTypeMultiChoice:customFieldTypeMultiChoice,customFieldTypeDate:customFieldTypeDate,urls:{getLicense:"/api/licenses/",getCustomFields:"/api/custom-fields/results/",getHistory:"/api/licenses/history/",getNotes:"/api/licenses/notes/"}},methods:{getLicense:function(){var e={id:this.licenseID};fetch(get(this.urls.getLicense,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return manageLicense.msgLicenseData=t,void(manageLicense.msgLicenseDataType=msgTypes.danger);manageLicense.licenseData=e.Data,manageLicense.licenseDataRetrieved=!0,manageLicense.passData()}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageLicense.msgLicenseData="An unknown error occured.  Please try again.",manageLicense.msgLicenseDataType=msgTypes.danger})},getCustomFieldResults:function(){var e={licenseID:this.licenseID};fetch(get(this.urls.getCustomFields,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return manageLicense.msgLicenseData=t,void(manageLicense.msgLicenseDataType=msgTypes.danger);manageLicense.customFieldResults=e.Data||[]}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageLicense.msgLicenseData="An unknown error occured.  Please try again.",manageLicense.msgLicenseDataType=msgTypes.danger})},getDownloadHistory:function(){var e={licenseID:this.licenseID};fetch(get(this.urls.getHistory,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return manageLicense.msgHistory=t,void(manageLicense.msgHistoryType=msgTypes.danger);manageLicense.downloadHistory=e.Data||[]}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageLicense.msgHistory="An unknown error occured.  Please try again.",manageLicense.msgHistoryType=msgTypes.danger})},refreshDownloadHistory:function(){setTimeout(manageLicense.getDownloadHistory,500)},getNotes:function(){var e={licenseID:this.licenseID};fetch(get(this.urls.getNotes,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return manageLicense.msgNotes=t,void(manageLicense.msgNotesType=msgTypes.danger);manageLicense.notes=e.Data||[]}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageLicense.msgNotes="An unknown error occured.  Please try again.",manageLicense.msgNotesType=msgTypes.danger})},setNoteModal:function(e){modalNote.initialize(e)},passData:function(){modalDisableLicense.licenseID=this.licenseID,modalNote.licenseID=this.licenseID,modalRenewLicense.licenseID=this.licenseID,modalRenewLicense.currentExpireDate=this.licenseData.ExpireDate}},mounted:function(){var e=parseInt(document.getElementById("licenseID").value);this.licenseID=e,this.getLicense(),this.getCustomFieldResults(),this.getDownloadHistory(),this.getNotes()}})),document.getElementById("modal-disableLicense")&&(modalDisableLicense=new Vue({name:"modalDisableLicense",delimiters:["[[","]]"],el:"#modal-disableLicense",data:{licenseID:0,note:"",submitting:!1,msgSave:"",msgSaveType:"",urls:{disableLicense:"/api/licenses/disable/"}},methods:{disableLicense:function(){var e;this.submitting?console.log("already submitting"):(this.msgSaveType=msgTypes.danger,this.licenseID<1?this.msgSave="Could not determine which license you want to disabled.":""!==this.note.trim()?(this.msgSaveType=msgTypes.primary,this.msgSave="Disabling license...",this.submitting=!0,e={id:this.licenseID,note:this.note},fetch(post(this.urls.disableLicense,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalDisableLicense.msgSave=e,modalDisableLicense.msgSaveType=msgTypes.danger,void(modalDisableLicense.submitting=!1);manageLicense.licenseData.Active=!1,manageLicense.getNotes(),modalDisableLicense.msgSave="License disabled!",modalDisableLicense.msgSaveType=msgTypes.primary}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalDisableLicense.msgSave="An unknown error occured. Please try again.",modalDisableLicense.msgSaveType=msgTypes.danger,modalDisableLicense.submitting=!1})):this.msgSave="You must provide a note describing why you are disabling this license.")}}})),document.getElementById("modal-note")&&(modalNote=new Vue({name:"modalNote",delimiters:["[[","]]"],el:"#modal-note",data:{licenseID:0,noteData:{LicenseID:0,Note:""},addingNew:!1,submitting:!1,msgSave:"",msgSaveType:"",urls:{add:"/api/licenses/notes/add/"}},computed:{modalTitle:function(){return this.addingNew?"Add Note":"Note Details"}},methods:{initialize:function(e){this.resetModal(),void 0!==e?(this.noteData=e,this.addingNew=!1):this.addingNew=!0},resetModal:function(){this.noteData={ID:0,LicenseID:0,Note:"",CreatedByUsername:"",DatetimeCreated:""},this.msgSave="",this.msgSaveType=""},add:function(){var e;this.submitting?console.log("already submitting"):(this.msgSaveType=msgTypes.danger,this.licenseID<1?this.msgSave="Could not determine which license you want to add a note for.":""!==this.noteData.Note.trim()?(this.msgSaveType=msgTypes.primary,this.msgSave="Adding note...",this.submitting=!0,this.noteData.LicenseID=this.licenseID,e={data:JSON.stringify(this.noteData)},fetch(post(this.urls.add,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalNote.msgSave=e,modalNote.msgSaveType=msgTypes.danger,void(modalNote.submitting=!1);manageLicense.getNotes(),modalNote.msgSave="Note added!",modalNote.msgSaveType=msgTypes.primary,setTimeout(function(){modalNote.msgSave="",modalNote.msgSaveType="",modalNote.submitting=!1,modalNote.resetModal()},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalNote.msgSave="An unknown error occured. Please try again.",modalNote.msgSaveType=msgTypes.danger,modalNote.submitting=!1})):this.msgSave="You must provide a note.")}}})),document.getElementById("modal-renewLicense")&&(modalRenewLicense=new Vue({name:"modalRenewLicense",delimiters:["[[","]]"],el:"#modal-renewLicense",data:{licenseID:0,currentExpireDate:"",newExpireDate:"",renewed:!1,submitting:!1,msgSave:"",msgSaveType:"",urls:{renew:"/api/licenses/renew/"}},computed:{minDate:function(){return dateAdd(this.currentExpireDate,1)}},methods:{renew:function(){var e;this.submitting?console.log("already submitting"):(this.msgSaveType=msgTypes.danger,this.licenseID<1?this.msgSave="Could not determine which license you want to renew.":""!==this.newExpireDate?(this.msgSaveType=msgTypes.primary,this.msgSave="Renewing license...",this.submitting=!0,e={id:this.licenseID,newExpireDate:this.newExpireDate},fetch(post(this.urls.renew,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return modalRenewLicense.msgSave=t,modalRenewLicense.msgSaveType=msgTypes.danger,void(modalRenewLicense.submitting=!1);modalRenewLicense.msgSave="License Renewed!",modalRenewLicense.renewed=!0;var s=e.Data;if(void 0===s)return createLicense.msg="Could not determine where to redirect you. This is an odd error...",void(createLicense.msgType=msgTypes.warning);setTimeout(function(){window.location.href="/license/?id="+s},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalRenewLicense.msgSave="An unknown error occured. Please try again.",modalRenewLicense.msgSaveType=msgTypes.danger,modalRenewLicense.submitting=!1})):this.msgSave="You must provide the new expiration date.")}},mounted:function(){var e=parseInt(document.getElementById("licenseID").value);this.licenseID=e}})),document.getElementById("manageUsers")&&(manageUsers=new Vue({name:"manageUsers",delimiters:["[[","]]"],el:"#manageUsers",data:{addingNew:!1,msgLoad:"",msgLoadType:"",users:[],usersRetrieved:!1,userSelectedID:0,userData:{},submitting:!1,msgSave:"",msgSaveType:"",minPasswordLength:10,password1:"",password2:"",forceLogoutBtnText:"Force Logout",forceLogoutSubmitting:!1,urls:{get:"/api/users/",add:"/api/users/add/",update:"/api/users/update/",forceLogout:"/api/users/force-logout/"}},computed:{addEditCardTitle:function(){return this.addingNew?"Add User":"Edit User"}},methods:{getUsers:function(){fetch(get(this.urls.get,{})).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return manageUsers.msgLoad=t,void(manageUsers.msgLoadType=msgTypes.danger);manageUsers.users=e.Data||[],manageUsers.usersRetrieved=!0}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageUsers.msgLoad="An unknown error occured.  Please try again.",manageUsers.msgLoadType=msgTypes.danger})},setField:function(e,t){this.userData[e]=t},setUIState:function(){this.addingNew?this.addingNew=!this.addingNew:(this.addingNew=!this.addingNew,this.userData={},this.userSelectedID=0,Vue.nextTick(function(){setToggle("btn-group-toggle",!1,!0)}),this.msgSave="",this.msgSaveType="")},update:function(){if(isNaN(this.userData.ID)||""===this.userData.ID||this.userData.ID<1)return this.msgSave="An error occured. Please reload this page and try again.",void(this.msgSaveType=msgTypes.danger);this.msgSave="Saving...",this.msgSaveType=msgTypes.primary,this.submitting=!0;var e={data:JSON.stringify(this.userData)};fetch(post(this.urls.update,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return manageUsers.msgSave=e,manageUsers.msgSaveType=msgTypes.danger,void(manageUsers.submitting=!1);manageUsers.msgSave="Changes saved!",manageUsers.msgSaveType=msgTypes.success,setTimeout(function(){manageUsers.msgSave="",manageUsers.msgSaveType=""},defaultTimeout),manageUsers.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageUsers.msgSave="An unknown error occured.  Please try again.",manageUsers.msgSaveType=msgTypes.danger,manageUsers.submitting=!1})},add:function(){var e;this.submitting?console.log("already submitting..."):(this.msgSaveType=msgTypes.danger,this.password1===this.password2?this.password1.length<this.minPasswordLength?this.msgSave="The password you provided is too short. It must be at least "+this.minPasswordLength+" characters long.":(this.msgSave="Adding...",this.msgSaveType=msgTypes.primary,this.submitting=!0,this.userData.PasswordInput1=this.password1,this.userData.PasswordInput2=this.password2,e={data:JSON.stringify(this.userData)},fetch(post("/api/users/add/",e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return manageUsers.msgSave=e,manageUsers.msgSaveType=msgTypes.danger,void(manageUsers.submitting=!1);manageUsers.getUsers(),manageUsers.msgSave="Added!",manageUsers.msgSaveType=msgTypes.success,manageUsers.userData={},manageUsers.password1="",setToggle("btn-group-toggle",!1,!(manageUsers.password2="")),setTimeout(function(){manageUsers.msgSave="",manageUsers.msgSaveType=""},defaultTimeout),manageUsers.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageUsers.msgSave="An unknown error occured.  Please try again.",manageUsers.msgSaveType=msgTypes.danger,manageUsers.submitting=!1})):this.msgSave="Passwords do not match.")},addOrUpdate:function(){this.submitting?console.log("already submitting..."):(this.msgSaveType=msgTypes.danger,""!==this.userData.Username&&void 0!==this.userData.Username?!1!==isEmail(this.userData.Username)?void 0!==this.userData.ID?this.update():this.add():this.msgSave="You must provide an email for a username":this.msgSave="You must provide a username (email).")},showUser:function(){if(!(this.userSelectedID<1))for(var t=this,e=0,s=this.users;e<s.length;e++)!function(e){if(e.ID!==t.userSelectedID)return;t.userData=e,Vue.nextTick(function(){setToggle("Active",e.Active),setToggle("Administrator",e.Administrator),setToggle("ViewLicenses",e.ViewLicenses),setToggle("CreateLicenses",e.CreateLicenses)}),modalChangePassword.setUserData(t.userSelectedID),modalChangePassword.setUserData(t.userSelectedID),modalActivate2FA.setUserData(t.userSelectedID),modalDeactivate2FA.setUserData(t.userSelectedID)}(s[e])},forceLogout:function(){var e;this.forceLogoutSubmitting||(this.forceLogoutSubmitting=!0,this.forceLogoutBtnText="Forcing logout...",e={userID:this.userData.ID},fetch(post(this.urls.forceLogout,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return manageUsers.msgSave=e,void(manageUsers.msgSaveType=msgTypes.danger);manageUsers.msgSave="",manageUsers.forceLogoutBtnText="Forcing logout...done!",setTimeout(function(){manageUsers.forceLogoutBtnText="Force Logout"},defaultTimeout)}).catch(function(e){console.log("fetch() error: >>",e,"<<"),manageUsers.msgSave="An unknown error occured.  Please try again.",manageUsers.msgSaveType=msgTypes.danger}),this.forceLogoutSubmitting=!1)},reset2FAActivationModal:function(){modalActivate2FA.resetModal()}},mounted:function(){this.getUsers();var e=document.getElementById("minPasswordLength").value;this.minPasswordLength=parseInt(e)}})),document.getElementById("modal-changePassword")&&(modalChangePassword=new Vue({name:"modalChangePassword",delimiters:["[[","]]"],el:"#modal-changePassword",data:{userID:0,minPasswordLength:10,password1:"",password2:"",submitting:!1,msg:"",msgType:"",urls:{changePwd:"/api/users/change-password/"}},methods:{setUserData:function(e){this.userID=e},save:function(){var e;this.submitting?console.log("already submitting..."):(this.msgType=msgTypes.danger,this.userID<1?this.msg="Cannot determine what user you want to set a new password for.  Please refresh this page.":this.password1===this.password2?this.password1.length<this.minPasswordLength?this.msg="The password you provided is too short. It must be at least "+this.minPasswordLength+" characters long.":(this.msgType=msgTypes.primary,this.msg="Saving new password",this.submitting=!0,e={userID:this.userID,password1:this.password1,password2:this.password2},fetch(post(this.urls.changePwd,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalChangePassword.msg=e,modalChangePassword.msgType=msgTypes.danger,void(modalChangePassword.submitting=!1);modalChangePassword.msg="Password Updated!",modalChangePassword.msgType=msgTypes.success,modalChangePassword.password1="",modalChangePassword.password2="",setTimeout(function(){modalChangePassword.msg=""},defaultTimeout),modalChangePassword.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalChangePassword.msg="An unknown error occured.  Please try again.",modalChangePassword.msgType=msgTypes.danger,modalChangePassword.submitting=!1})):this.msg="Passwords do not match.")}},mounted:function(){var e=document.getElementById("minPasswordLength").value;this.minPasswordLength=parseInt(e)}})),document.getElementById("modal-activate2FA")&&(modalActivate2FA=new Vue({name:"modalActivate2FA",delimiters:["[[","]]"],el:"#modal-activate2FA",data:{userID:0,twoFABarcode:"",twoFAVerificationCode:"",show2FAInfoOnly:!0,retrievingBarcode:!1,submitting:!1,msg:"",msgType:"",urls:{get2FABarcode:"/api/users/2fa/get-qr-code/",verify2FA:"/api/users/2fa/verify/"}},methods:{setUserData:function(e){this.userID=e},getBarcode:function(){this.show2FAInfoOnly=!1,this.retrievingBarcode=!0;var e={userID:this.userID};fetch(get(this.urls.get2FABarcode,e)).then(handleRequestErrors).then(getJSON).then(function(e){var t=handleAPIErrors(e);if(""!==t)return modalActivate2FA.msg=t,modalActivate2FA.msgType=msgTypes.danger,void(modalActivate2FA.retrievingBarcode=!1);modalActivate2FA.twoFABarcode=e.Data,modalActivate2FA.retrievingBarcode=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalActivate2FA.msg="An unknown error occured.  Please try again.",modalActivate2FA.msgType=msgTypes.danger,modalActivate2FA.retrievingBarcode=!1})},validate:function(){this.submitting=!0;var e={userID:this.userID,validationCode:this.twoFAVerificationCode};fetch(post(this.urls.verify2FA,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalActivate2FA.msg=e,modalActivate2FA.msgType=msgTypes.danger,void(modalActivate2FA.submitting=!1);modalActivate2FA.msg="Code verified! 2 Factor Authentication is now enabled for this user.",modalActivate2FA.msgType=msgTypes.success;for(var t=0;t<manageUsers.users.length;t++){var s=manageUsers.users[t];if(s.ID===modalActivate2FA.userID){s.TwoFactorAuthEnabled=!0;break}}}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalActivate2FA.msg="An unknown error occured.  Please try again.",modalActivate2FA.msgType=msgTypes.danger,modalActivate2FA.submitting=!1})},resetModal:function(){this.msg="",this.msgType="",this.twoFABarcode="",this.twoFAVerificationCode="",this.show2FAInfoOnly=!0,this.submitting=!1}}})),document.getElementById("modal-deactivate2FA")&&(modalDeactivate2FA=new Vue({name:"modalDeactivate2FA",delimiters:["[[","]]"],el:"#modal-deactivate2FA",data:{userID:0,submitting:!1,msg:"",msgType:"",urls:{deactivate2FA:"/api/users/2fa/deactivate/"}},methods:{setUserData:function(e){this.userID=e},deactivate:function(){this.submitting=!0;var e={userID:this.userID};fetch(post(this.urls.deactivate2FA,e)).then(handleRequestErrors).then(getJSON).then(function(e){e=handleAPIErrors(e);if(""!==e)return modalDeactivate2FA.msg=e,modalDeactivate2FA.msgType=msgTypes.danger,void(modalDeactivate2FA.submitting=!1);modalDeactivate2FA.msg="2 Factor Authentication is now disabled for this user.",modalDeactivate2FA.msgType=msgTypes.success,setTimeout(function(){for(var e=0;e<manageUsers.users.length;e++){var t=manageUsers.users[e];if(t.ID===modalDeactivate2FA.userID){t.TwoFactorAuthEnabled=!1;break}}modalDeactivate2FA.msg="",modalDeactivate2FA.msgType=""},defaultTimeout),modalDeactivate2FA.submitting=!1}).catch(function(e){console.log("fetch() error: >>",e,"<<"),modalDeactivate2FA.msg="An unknown error occured.  Please try again.",modalDeactivate2FA.msgType=msgTypes.danger,modalDeactivate2FA.submitting=!1})}}}));